
<!DOCTYPE html>

<html lang="Python">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pyaedt.hfss &#8212; PyAEDT 0.2.0 documentation</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><style>
    .navbar-light {
        background-color: black !important;
    }
</style>

<div class="container-xl">

    <a class="navbar-brand" href="../../index.html">
    
      <img src="../../_static/pyansys-logo-black-cropped.png" class="logo" alt="logo" />
    
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon" >
        <i class="fas fa-bars" style="color:#fff; font-size:28px;"></i>
      </span>
    </button>
    
    <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item ">
            <a class="nav-link" href="../../Resources/Installation.html">Installation</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../API/API.html">API documentation</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../Resources/Code_Guidelines.html">Code Guidelines</a>
        </li>
        
        
      </ul>


      

      <ul class="navbar-nav">
        
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/pyansys/PyAEDT" target="_blank" rel="noopener">
              <span><i class="fab fa-github-square" style="font-size:24px"></i></span>
            </a>
          </li>
        
        
        
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <h1>Source code for pyaedt.hfss</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Hfss Class</span>
<span class="sd">----------------------------------------------------------------</span>


<span class="sd">Description</span>
<span class="sd">==================================================</span>

<span class="sd">This class contains all HFSS functionalities. It inherits all objects that belong to HFSS.</span>


<span class="sd">Examples:</span>

<span class="sd">hfss = Hfss()     Creates an ``Hfss`` object and connects to an existing HFSS design or creates a new HFSS design if one is not present.</span>


<span class="sd">hfss = Hfss(projectname)     Creates an ``Hfss`` object and links to a project named projectname. If this project doesn&#39;t exist, it creates one with this name.</span>


<span class="sd">hfss = Hfss(projectname,designame)     Creates an ``Hfss`` object and links to a design named designname in a project named projectname.</span>


<span class="sd">hfss = Hfss(&quot;myfile.aedt&quot;)     Creates an ``Hfss`` object and opens the specified project.</span>


<span class="sd">========================================================</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">.application.Analysis3D</span> <span class="kn">import</span> <span class="n">FieldAnalysis3D</span>
<span class="kn">from</span> <span class="nn">.desktop</span> <span class="kn">import</span> <span class="n">exception_to_desktop</span>
<span class="kn">from</span> <span class="nn">.modeler.GeometryOperators</span> <span class="kn">import</span> <span class="n">GeometryOperators</span>
<span class="kn">from</span> <span class="nn">.modules.Boundary</span> <span class="kn">import</span> <span class="n">BoundaryObject</span>
<span class="kn">from</span> <span class="nn">.generic.general_methods</span> <span class="kn">import</span> <span class="n">generate_unique_name</span><span class="p">,</span> <span class="n">aedt_exception_handler</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">from</span> <span class="nn">.application.DataHandlers</span> <span class="kn">import</span> <span class="n">random_string</span>


<div class="viewcode-block" id="Hfss"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss">[docs]</a><span class="k">class</span> <span class="nc">Hfss</span><span class="p">(</span><span class="n">FieldAnalysis3D</span><span class="p">,</span> <span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;HFSS object&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;HFSS </span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">. ProjectName:</span><span class="si">{}</span><span class="s2"> DesignName:</span><span class="si">{}</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_aedt_version</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">design_name</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;HFSS Module&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">projectname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">designname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">solution_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">setup_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;HFSS Object</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            projectname :</span>
<span class="sd">                name of the project to be selected or full path to the project to be opened  or to the AEDTZ archive. if None try to get active project and, if nothing present to create an empty one</span>
<span class="sd">            designname :</span>
<span class="sd">                name of the design to be selected. if None, try to get active design and, if nothing present to create an empty one</span>
<span class="sd">            solution_type :</span>
<span class="sd">                solution type to be applied to design. if None default is taken</span>
<span class="sd">            setup_name :</span>
<span class="sd">                setup_name to be used as nominal. if none active setup is taken or nothing</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">FieldAnalysis3D</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;HFSS&quot;</span><span class="p">,</span> <span class="n">projectname</span><span class="p">,</span> <span class="n">designname</span><span class="p">,</span> <span class="n">solution_type</span><span class="p">,</span> <span class="n">setup_name</span><span class="p">)</span>
    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ex_type</span><span class="p">,</span> <span class="n">ex_value</span><span class="p">,</span> <span class="n">ex_traceback</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Push exit up to parent object Design &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ex_type</span><span class="p">:</span>
            <span class="n">exception_to_desktop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ex_value</span><span class="p">,</span> <span class="n">ex_traceback</span><span class="p">)</span>

<div class="viewcode-block" id="Hfss.BoundaryType"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.BoundaryType">[docs]</a>    <span class="k">class</span> <span class="nc">BoundaryType</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; &quot;&quot;&quot;</span>
        <span class="p">(</span><span class="n">PerfectE</span><span class="p">,</span> <span class="n">PerfectH</span><span class="p">,</span> <span class="n">Aperture</span><span class="p">,</span> <span class="n">Radiation</span><span class="p">,</span> <span class="n">Impedance</span><span class="p">,</span> <span class="n">LayeredImp</span><span class="p">,</span> <span class="n">LumpedRLC</span><span class="p">,</span> <span class="n">FiniteCond</span><span class="p">)</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span></div>

    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">_create_lumped_driven</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objectname</span><span class="p">,</span> <span class="n">int_line_start</span><span class="p">,</span> <span class="n">int_line_stop</span><span class="p">,</span> <span class="n">impedance</span><span class="p">,</span> <span class="n">portname</span><span class="p">,</span><span class="n">renorm</span><span class="p">,</span> <span class="n">deemb</span><span class="p">):</span>
        <span class="n">start</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">model_units</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">int_line_start</span><span class="p">]</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">model_units</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">int_line_stop</span><span class="p">]</span>
        <span class="n">props</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">({</span><span class="s2">&quot;Objects&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">objectname</span><span class="p">],</span> <span class="s2">&quot;DoDeembed&quot;</span><span class="p">:</span> <span class="n">deemb</span><span class="p">,</span> <span class="s2">&quot;RenormalizeAllTerminals&quot;</span><span class="p">:</span> <span class="n">renorm</span><span class="p">,</span>
                             <span class="s2">&quot;Modes&quot;</span><span class="p">:</span> <span class="n">OrderedDict</span><span class="p">({</span><span class="s2">&quot;Mode1&quot;</span><span class="p">:</span> <span class="n">OrderedDict</span><span class="p">({</span><span class="s2">&quot;ModeNum&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;UseIntLine&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                                                                         <span class="s2">&quot;IntLine&quot;</span><span class="p">:</span> <span class="n">OrderedDict</span><span class="p">(</span>
                                                                             <span class="p">{</span><span class="s2">&quot;Start&quot;</span><span class="p">:</span> <span class="n">start</span><span class="p">,</span> <span class="s2">&quot;End&quot;</span><span class="p">:</span> <span class="n">stop</span><span class="p">}),</span>
                                                                         <span class="s2">&quot;AlignmentGroup&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;CharImp&quot;</span><span class="p">:</span> <span class="s2">&quot;Zpi&quot;</span><span class="p">,</span>
                                                                         <span class="s2">&quot;RenormImp&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">impedance</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;ohm&quot;</span><span class="p">})}),</span>
                             <span class="s2">&quot;ShowReporterFilter&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                             <span class="s2">&quot;ReporterFilter&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">],</span>
                             <span class="s2">&quot;Impedance&quot;</span>	<span class="p">:</span>  <span class="nb">str</span><span class="p">(</span><span class="n">impedance</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;ohm&quot;</span><span class="p">})</span>
        <span class="n">bound</span> <span class="o">=</span> <span class="n">BoundaryObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">portname</span><span class="p">,</span><span class="n">props</span><span class="p">,</span> <span class="s2">&quot;LumpedPort&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bound</span><span class="o">.</span><span class="n">create</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bound</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">bound</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">_create_port_terminal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objectname</span><span class="p">,</span> <span class="n">int_line_stop</span><span class="p">,</span> <span class="n">portname</span><span class="p">,</span> <span class="n">iswaveport</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">ref_conductors</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">convert_to_selections</span><span class="p">(</span><span class="n">int_line_stop</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">props</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">({})</span>
        <span class="n">props</span><span class="p">[</span><span class="s2">&quot;Faces&quot;</span><span class="p">]</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">objectname</span><span class="p">)</span>
        <span class="n">props</span><span class="p">[</span><span class="s2">&quot;IsWavePort&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">iswaveport</span>
        <span class="n">props</span><span class="p">[</span><span class="s2">&quot;ReferenceConductors&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">ref_conductors</span>
        <span class="n">props</span><span class="p">[</span><span class="s2">&quot;RenormalizeModes&quot;</span><span class="p">]</span><span class="o">=</span><span class="kc">True</span>
        <span class="n">bound</span> <span class="o">=</span> <span class="n">BoundaryObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">portname</span><span class="p">,</span> <span class="n">props</span><span class="p">,</span> <span class="s2">&quot;AutoIdentify&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bound</span><span class="o">.</span><span class="n">create</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bound</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">bound</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">_create_circuit_port</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edgelist</span><span class="p">,</span> <span class="n">impedance</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">renorm</span><span class="p">,</span> <span class="n">deemb</span><span class="p">,</span> <span class="n">renorm_impedance</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="n">edgelist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">_convert_list_to_ids</span><span class="p">(</span><span class="n">edgelist</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">props</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">({</span><span class="s2">&quot;Edges&quot;</span><span class="p">:</span> <span class="n">edgelist</span><span class="p">,</span> <span class="s2">&quot;Impedance&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">impedance</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;ohm&quot;</span><span class="p">,</span> <span class="s2">&quot;DoDeembed&quot;</span><span class="p">:</span> <span class="n">deemb</span><span class="p">,</span>
                             <span class="s2">&quot;RenormalizeAllTerminals&quot;</span><span class="p">:</span> <span class="n">renorm</span><span class="p">})</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="o">==</span> <span class="s2">&quot;DrivenModal&quot;</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">renorm</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">renorm_impedance</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">renorm_impedance</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">float</span> <span class="ow">or</span> <span class="s1">&#39;i&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">renorm_impedance</span><span class="p">:</span>
                    <span class="n">renorm_imp</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">renorm_impedance</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;ohm&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">renorm_imp</span> <span class="o">=</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">renorm_impedance</span> <span class="o">+</span> <span class="s1">&#39;) ohm&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">renorm_imp</span> <span class="o">=</span> <span class="s1">&#39;0ohm&#39;</span>
            <span class="n">props</span><span class="p">[</span><span class="s2">&quot;RenormImp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">renorm_imp</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">props</span><span class="p">[</span><span class="s2">&quot;TerminalIDList&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">bound</span> <span class="o">=</span> <span class="n">BoundaryObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">props</span><span class="p">,</span> <span class="s2">&quot;CircuitPort&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bound</span><span class="o">.</span><span class="n">create</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bound</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">bound</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">_create_waveport_driven</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objectname</span><span class="p">,</span> <span class="n">int_line_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">int_line_stop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">impedance</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">portname</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                                <span class="n">renorm</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nummodes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">deemb_distance</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">start</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">int_line_start</span> <span class="ow">and</span> <span class="n">int_line_stop</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">model_units</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">int_line_start</span><span class="p">]</span>
            <span class="n">stop</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">model_units</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">int_line_stop</span><span class="p">]</span>
            <span class="n">useintline</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">useintline</span><span class="o">=</span><span class="kc">False</span>

        <span class="n">props</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">({})</span>
        <span class="n">props</span><span class="p">[</span><span class="s2">&quot;Objects&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">objectname</span><span class="p">]</span>
        <span class="n">props</span><span class="p">[</span><span class="s2">&quot;NumModes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nummodes</span>
        <span class="n">props</span><span class="p">[</span><span class="s2">&quot;UseLineModeAlignment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">deemb_distance</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">props</span><span class="p">[</span><span class="s2">&quot;DoDeembed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">props</span><span class="p">[</span><span class="s2">&quot;DeembedDist&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">deemb_distance</span><span class="p">)</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">model_units</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">props</span><span class="p">[</span><span class="s2">&quot;DoDeembed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">props</span><span class="p">[</span><span class="s2">&quot;RenormalizeAllTerminals&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">renorm</span>
        <span class="n">modes</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">({})</span>
        <span class="n">arg2</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">arg2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NAME:Modes&quot;</span><span class="p">)</span>
        <span class="n">i</span><span class="o">=</span><span class="mi">1</span>
        <span class="n">report_filter</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">while</span> <span class="n">i</span><span class="o">&lt;=</span><span class="n">nummodes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">mode</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">({})</span>
                <span class="n">mode</span><span class="p">[</span><span class="s2">&quot;ModeNum&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
                <span class="n">mode</span><span class="p">[</span><span class="s2">&quot;UseIntLine&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">useintline</span>
                <span class="k">if</span> <span class="n">useintline</span><span class="p">:</span>
                    <span class="n">mode</span><span class="p">[</span><span class="s2">&quot;IntLine&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">({</span><span class="s2">&quot;Start&quot;</span><span class="p">:</span> <span class="n">start</span><span class="p">,</span> <span class="s2">&quot;End&quot;</span><span class="p">:</span> <span class="n">stop</span><span class="p">})</span>
                <span class="n">mode</span><span class="p">[</span><span class="s2">&quot;AlignmentGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">mode</span><span class="p">[</span><span class="s2">&quot;CharImp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Zpi&quot;</span>
                <span class="n">mode</span><span class="p">[</span><span class="s2">&quot;RenormImp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">impedance</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;ohm&quot;</span>
                <span class="n">modes</span><span class="p">[</span><span class="s2">&quot;Mode1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mode</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">mode</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">({})</span>

                <span class="n">mode</span><span class="p">[</span><span class="s2">&quot;ModeNum&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
                <span class="n">mode</span><span class="p">[</span><span class="s2">&quot;UseIntLine&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">mode</span><span class="p">[</span><span class="s2">&quot;AlignmentGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">mode</span><span class="p">[</span><span class="s2">&quot;CharImp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Zpi&quot;</span>
                <span class="n">mode</span><span class="p">[</span><span class="s2">&quot;RenormImp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">impedance</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;ohm&quot;</span>
                <span class="n">modes</span><span class="p">[</span><span class="s2">&quot;Mode&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="n">mode</span>
            <span class="n">report_filter</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">props</span><span class="p">[</span><span class="s2">&quot;Modes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">modes</span>
        <span class="n">props</span><span class="p">[</span><span class="s2">&quot;ShowReporterFilter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">props</span><span class="p">[</span><span class="s2">&quot;ReporterFilter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">report_filter</span>
        <span class="n">props</span><span class="p">[</span><span class="s2">&quot;UseAnalyticAlignment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">bound</span> <span class="o">=</span> <span class="n">BoundaryObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">portname</span><span class="p">,</span> <span class="n">props</span><span class="p">,</span> <span class="s2">&quot;WavePort&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bound</span><span class="o">.</span><span class="n">create</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bound</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">bound</span>
        <span class="k">return</span> <span class="kc">False</span>

<div class="viewcode-block" id="Hfss.assigncoating"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.assigncoating">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">assigncoating</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">mat</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">cond</span><span class="o">=</span><span class="mi">58000000</span><span class="p">,</span> <span class="n">perm</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">usethickness</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="s2">&quot;0.1mm&quot;</span><span class="p">,</span> <span class="n">roughness</span><span class="o">=</span><span class="s2">&quot;0um&quot;</span><span class="p">,</span>
                      <span class="n">isinfgnd</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">istwoside</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">isInternal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">issheelElement</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">usehuray</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                      <span class="n">radius</span><span class="o">=</span><span class="s2">&quot;0.5um&quot;</span><span class="p">,</span> <span class="n">ratio</span><span class="o">=</span><span class="s2">&quot;2.9&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The function assigns Finite Conductivity to object obj with material mat</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        obj : list or str</span>
<span class="sd">            object list</span>
<span class="sd">        mat : str</span>
<span class="sd">            material name to use, optional (Default value = None)</span>
<span class="sd">        cond : float</span>
<span class="sd">            if not material is provided user has to provide conductivity (Default value = 58000000)</span>
<span class="sd">        perm : float</span>
<span class="sd">            if not material is provided user has to provide permittivity (Default value = 1)</span>
<span class="sd">        usethickness : bool</span>
<span class="sd">            boolean (Default value = False)</span>
<span class="sd">        thickness : str</span>
<span class="sd">            thickness value in case usethickness=True (Default value = &quot;0.1mm&quot;)</span>
<span class="sd">        roughness : str</span>
<span class="sd">            optional roughness value (Default value = &quot;0um&quot;)</span>
<span class="sd">        isinfgnd : bool</span>
<span class="sd">            Boolean (Default value = False)</span>
<span class="sd">        istwoside : bool</span>
<span class="sd">            Boolean (Default value = False)</span>
<span class="sd">        isInternal : bool</span>
<span class="sd">            Boolean (Default value = True)</span>
<span class="sd">        issheelElement : bool</span>
<span class="sd">            Boolena (Default value = False)</span>
<span class="sd">        usehuray : bool</span>
<span class="sd">            Boolean (Default value = False)</span>
<span class="sd">        radius : str</span>
<span class="sd">            Huray Coefficient (Default value = &quot;0.5um&quot;)</span>
<span class="sd">        ratio : str</span>
<span class="sd">            Huray Coefficient (Default value = &quot;2.9&quot;)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class: BoundaryObject</span>
<span class="sd">            Boundary Object</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; id1 = aedtapp.modeler.primitives.get_obj_id(&quot;inner&quot;)</span>
<span class="sd">        &gt;&gt;&gt; coat = aedtapp.assigncoating([id1], &quot;copper&quot;,usethickness=True, thickness=&quot;0.2mm&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">mat</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">listobj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">convert_to_selections</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">listobjname</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">listobj</span><span class="p">)</span>
        <span class="n">props</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Objects&quot;</span> <span class="p">:</span> <span class="n">listobj</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">mat</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">materials</span><span class="o">.</span><span class="n">material_keys</span><span class="p">:</span>
                <span class="n">Mat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">materials</span><span class="o">.</span><span class="n">material_keys</span><span class="p">[</span><span class="n">mat</span><span class="p">]</span>
                <span class="n">Mat</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
                <span class="n">props</span><span class="p">[</span><span class="s1">&#39;UseMaterial&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">props</span><span class="p">[</span><span class="s1">&#39;Material&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mat</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">materials</span><span class="o">.</span><span class="n">_aedmattolibrary</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">materials</span><span class="o">.</span><span class="n">checkifmaterialexists</span><span class="p">(</span><span class="n">mat</span><span class="p">):</span>
                <span class="n">props</span><span class="p">[</span><span class="s1">&#39;UseMaterial&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">props</span><span class="p">[</span><span class="s1">&#39;Material&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mat</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">props</span><span class="p">[</span><span class="s1">&#39;UseMaterial&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">props</span><span class="p">[</span><span class="s1">&#39;Conductivity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">cond</span><span class="p">)</span>
            <span class="n">props</span><span class="p">[</span><span class="s1">&#39;Permeability&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">perm</span><span class="p">))</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;UseThickness&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">usethickness</span>
        <span class="k">if</span> <span class="n">usethickness</span><span class="p">:</span>
            <span class="n">props</span><span class="p">[</span><span class="s1">&#39;Thickness&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thickness</span>
        <span class="k">if</span> <span class="n">usehuray</span><span class="p">:</span>
            <span class="n">props</span><span class="p">[</span><span class="s1">&#39;Radius&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
            <span class="n">props</span><span class="p">[</span><span class="s1">&#39;Ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">ratio</span><span class="p">)</span>
            <span class="n">props</span><span class="p">[</span><span class="s1">&#39;InfGroundPlane&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">props</span><span class="p">[</span><span class="s1">&#39;Roughness&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">roughness</span>
            <span class="n">props</span><span class="p">[</span><span class="s1">&#39;InfGroundPlane&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">isinfgnd</span>
        <span class="n">props</span><span class="p">[</span><span class="s1">&#39;IsTwoSided&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">istwoside</span>

        <span class="k">if</span> <span class="n">istwoside</span><span class="p">:</span>
            <span class="n">props</span><span class="p">[</span><span class="s1">&#39;IsShellElement&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">issheelElement</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">props</span><span class="p">[</span><span class="s1">&#39;IsInternal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">isInternal</span>
        <span class="n">bound</span> <span class="o">=</span> <span class="n">BoundaryObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Coating_&quot;</span> <span class="o">+</span> <span class="n">listobjname</span><span class="p">[:</span><span class="mi">32</span><span class="p">],</span> <span class="n">props</span><span class="p">,</span> <span class="s2">&quot;FiniteCond&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bound</span><span class="o">.</span><span class="n">create</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_messenger</span><span class="o">.</span><span class="n">add_debug_message</span><span class="p">(</span><span class="s1">&#39;Assigned Coating &#39;</span> <span class="o">+</span> <span class="n">mat</span> <span class="o">+</span> <span class="s1">&#39; to object &#39;</span> <span class="o">+</span> <span class="n">listobjname</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bound</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">bound</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Hfss.create_frequency_sweep"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.create_frequency_sweep">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">create_frequency_sweep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">setupname</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;GHz&quot;</span><span class="p">,</span> <span class="n">freqstart</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">freqstop</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">sweepname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                               <span class="n">num_of_freq_points</span><span class="o">=</span><span class="mi">451</span><span class="p">,</span> <span class="n">sweeptype</span><span class="o">=</span><span class="s2">&quot;Interpolating&quot;</span><span class="p">,</span>
                               <span class="n">interpolation_tol</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">interpolation_max_solutions</span><span class="o">=</span><span class="mi">250</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a Frequency Sweep</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        setupname : str</span>
<span class="sd">            name of the setup to which is attached the sweep</span>
<span class="sd">        unit :</span>
<span class="sd">            Units (&quot;MHz&quot;, &quot;GHz&quot;....) (Default value = &quot;GHz&quot;)</span>
<span class="sd">        freqstart :</span>
<span class="sd">            Starting Frequency of sweep (Default value = 1e-3)</span>
<span class="sd">        freqstop :</span>
<span class="sd">            Stop Frequency of Sweep (Default value = 10)</span>
<span class="sd">        sweepname :</span>
<span class="sd">            name of the Sweep (Default value = None)</span>
<span class="sd">        num_of_freq_points :</span>
<span class="sd">            Number of frequency point in the range (Default value = 451)</span>
<span class="sd">        sweeptype :</span>
<span class="sd">            Fast&quot;|&quot;Interpolating&quot;|&quot;Discrete&quot; (default)</span>
<span class="sd">        interpolation_max_solutions :</span>
<span class="sd">            max number of solutions evaluated for the interpolation process (Default value = 250)</span>
<span class="sd">        interpolation_tol :</span>
<span class="sd">            error tolerance threshold for the interpolation process (Default value = 0.5)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        type</span>
<span class="sd">            True if operation succeeded</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">sweepname</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sweepname</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Sweep&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">setupname</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">setup_names</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">setups</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">setupname</span><span class="p">:</span>
                <span class="n">setupdata</span> <span class="o">=</span> <span class="n">i</span>
                <span class="k">for</span> <span class="n">sw</span> <span class="ow">in</span> <span class="n">setupdata</span><span class="o">.</span><span class="n">sweeps</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">sweepname</span> <span class="o">==</span> <span class="n">sw</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">messenger</span><span class="o">.</span><span class="n">add_warning_message</span><span class="p">(</span><span class="s2">&quot;Sweep </span><span class="si">{}</span><span class="s2"> already present. Please rename and retry&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sweepname</span><span class="p">))</span>
                        <span class="k">return</span> <span class="kc">False</span>
                <span class="n">sweepdata</span> <span class="o">=</span> <span class="n">setupdata</span><span class="o">.</span><span class="n">add_sweep</span><span class="p">(</span><span class="n">sweepname</span><span class="p">,</span> <span class="n">sweeptype</span><span class="p">)</span>
                <span class="n">sweepdata</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;RangeStart&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">freqstart</span><span class="p">)</span> <span class="o">+</span> <span class="n">unit</span>
                <span class="n">sweepdata</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;RangeEnd&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">freqstop</span><span class="p">)</span> <span class="o">+</span> <span class="n">unit</span>
                <span class="n">sweepdata</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;RangeCount&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">num_of_freq_points</span>
                <span class="n">sweepdata</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sweeptype</span>
                <span class="k">if</span> <span class="n">sweeptype</span> <span class="o">==</span> <span class="s2">&quot;Interpolating&quot;</span><span class="p">:</span>
                    <span class="n">sweepdata</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;InterpTolerance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolation_tol</span>
                    <span class="n">sweepdata</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;InterpMaxSolns&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolation_max_solutions</span>
                    <span class="n">sweepdata</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;InterpMinSolns&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">sweepdata</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;InterpMinSubranges&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

                <span class="n">sweepdata</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;RangeStart&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">freqstart</span><span class="p">)</span> <span class="o">+</span> <span class="n">unit</span>
                <span class="n">sweepdata</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
                <span class="k">return</span> <span class="n">sweepname</span></div>


<div class="viewcode-block" id="Hfss.create_linear_count_sweep"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.create_linear_count_sweep">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">create_linear_count_sweep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">setupname</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">freqstart</span><span class="p">,</span> <span class="n">freqstop</span><span class="p">,</span> <span class="n">num_of_freq_points</span><span class="p">,</span>
                                  <span class="n">sweepname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save_fields</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save_rad_fields</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a Discrete Sweep with specified the number of points</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        setupname : str</span>
<span class="sd">            Setup name</span>
<span class="sd">        freqstart : float</span>
<span class="sd">            Starting Frequency of sweep (eg. 1)</span>
<span class="sd">        freqstop : float</span>
<span class="sd">            Stop Frequency of Sweep</span>
<span class="sd">        sweepname : str</span>
<span class="sd">            name of the Sweep (Default value = None)</span>
<span class="sd">        unit : str</span>
<span class="sd">            Units (&quot;MHz&quot;, &quot;GHz&quot;....)</span>
<span class="sd">        num_of_freq_points : int</span>
<span class="sd">            Number of frequency point in the range</span>
<span class="sd">        save_fields : bool</span>
<span class="sd">            bool (Default value = True)</span>
<span class="sd">        save_rad_fields :</span>
<span class="sd">            bool (Default value = False)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class: SweepHFSS</span>
<span class="sd">            sweepname</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">sweepname</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sweepname</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Sweep&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">setupname</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">setup_names</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">setups</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">setupname</span><span class="p">:</span>
                <span class="n">setupdata</span> <span class="o">=</span> <span class="n">i</span>
                <span class="k">for</span> <span class="n">sw</span> <span class="ow">in</span> <span class="n">setupdata</span><span class="o">.</span><span class="n">sweeps</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">sweepname</span> <span class="o">==</span> <span class="n">sw</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">messenger</span><span class="o">.</span><span class="n">add_warning_message</span><span class="p">(</span><span class="s2">&quot;Sweep </span><span class="si">{}</span><span class="s2"> already present. Please rename and retry&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sweepname</span><span class="p">))</span>
                        <span class="k">return</span> <span class="kc">False</span>
                <span class="n">sweepdata</span> <span class="o">=</span> <span class="n">setupdata</span><span class="o">.</span><span class="n">add_sweep</span><span class="p">(</span><span class="n">sweepname</span><span class="p">,</span> <span class="s2">&quot;Discrete&quot;</span><span class="p">)</span>
                <span class="n">sweepdata</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;RangeStart&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">freqstart</span><span class="p">)</span> <span class="o">+</span> <span class="n">unit</span><span class="p">,</span>
                <span class="n">sweepdata</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;RangeEnd&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">freqstop</span><span class="p">)</span> <span class="o">+</span> <span class="n">unit</span><span class="p">,</span>
                <span class="n">sweepdata</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;RangeCount&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">num_of_freq_points</span><span class="p">,</span>
                <span class="n">sweepdata</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;SaveFields&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">save_fields</span>
                <span class="n">sweepdata</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;SaveRadFields&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">save_rad_fields</span>
                <span class="n">sweepdata</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Discrete&quot;</span>
                <span class="n">sweepdata</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;RangeType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;LinearCount&quot;</span>
                <span class="n">sweepdata</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;ExtrapToDC&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">sweepdata</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
                <span class="k">return</span> <span class="n">sweepname</span></div>

<div class="viewcode-block" id="Hfss.create_linear_step_sweep"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.create_linear_step_sweep">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">create_linear_step_sweep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">setupname</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">freqstart</span><span class="p">,</span> <span class="n">freqstop</span><span class="p">,</span> <span class="n">step_size</span><span class="p">,</span>
                                 <span class="n">sweepname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save_fields</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save_rad_fields</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a Discrete Sweep with specified the number of points</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        freqstart : float</span>
<span class="sd">            Starting Frequency of sweep</span>
<span class="sd">        freqstop : float</span>
<span class="sd">            Stop Frequency of Sweep</span>
<span class="sd">        sweepname : str</span>
<span class="sd">            name of the Sweep (Default value = None)</span>
<span class="sd">        unit : str</span>
<span class="sd">            Units (&quot;MHz&quot;, &quot;GHz&quot;....)</span>
<span class="sd">        step_size : float</span>
<span class="sd">            Frequency size of the step</span>
<span class="sd">        setupname : str</span>
<span class="sd">            Setup name</span>
<span class="sd">        save_fields : bool</span>
<span class="sd">            bool (Default value = True)</span>
<span class="sd">        save_rad_fields : bool</span>
<span class="sd">            bool (Default value = False)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class: SweepHFSS</span>
<span class="sd">            sweepname</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">sweepname</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sweepname</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Sweep&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">setupname</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">setup_names</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">setups</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">setupname</span><span class="p">:</span>
                <span class="n">setupdata</span> <span class="o">=</span> <span class="n">i</span>
                <span class="k">for</span> <span class="n">sw</span> <span class="ow">in</span> <span class="n">setupdata</span><span class="o">.</span><span class="n">sweeps</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">sweepname</span> <span class="o">==</span> <span class="n">sw</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">messenger</span><span class="o">.</span><span class="n">add_warning_message</span><span class="p">(</span><span class="s2">&quot;Sweep </span><span class="si">{}</span><span class="s2"> already present. Please rename and retry&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sweepname</span><span class="p">))</span>
                        <span class="k">return</span> <span class="kc">False</span>
                <span class="n">sweepdata</span> <span class="o">=</span> <span class="n">setupdata</span><span class="o">.</span><span class="n">add_sweep</span><span class="p">(</span><span class="n">sweepname</span><span class="p">,</span> <span class="s2">&quot;Discrete&quot;</span><span class="p">)</span>
                <span class="n">sweepdata</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;RangeStart&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">freqstart</span><span class="p">)</span> <span class="o">+</span> <span class="n">unit</span>
                <span class="n">sweepdata</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;RangeEnd&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">freqstop</span><span class="p">)</span> <span class="o">+</span> <span class="n">unit</span>
                <span class="n">sweepdata</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;RangeStep&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">step_size</span><span class="p">)</span> <span class="o">+</span> <span class="n">unit</span>
                <span class="n">sweepdata</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;SaveFields&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">save_fields</span>
                <span class="n">sweepdata</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;SaveRadFields&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">save_rad_fields</span>
                <span class="n">sweepdata</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;ExtrapToDC&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">sweepdata</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Discrete&quot;</span>
                <span class="n">sweepdata</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;RangeType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;LinearStep&quot;</span>
                <span class="n">sweepdata</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
                <span class="k">return</span> <span class="n">sweepname</span></div>


<div class="viewcode-block" id="Hfss.create_discrete_sweep"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.create_discrete_sweep">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">create_discrete_sweep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">setupname</span><span class="p">,</span> <span class="n">sweepname</span><span class="o">=</span><span class="s2">&quot;SinglePoint&quot;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;1GHz&quot;</span><span class="p">,</span> <span class="n">save_field</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save_radiating_field</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a Discrete Sweep with a single frequency value</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        setupname : str</span>
<span class="sd">            Setup name</span>
<span class="sd">        freq : str</span>
<span class="sd">            sweep freq (including Units) as string (Default value = &quot;1GHz&quot;)</span>
<span class="sd">        sweepname : str</span>
<span class="sd">            name of the sweep (Default value = &quot;SinglePoint&quot;)</span>
<span class="sd">        save_field : bool</span>
<span class="sd">            bool (Default value = True)</span>
<span class="sd">        save_radiating_field : bool</span>
<span class="sd">            bool (Default value = False)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class: SweepHFSS</span>
<span class="sd">            sweepname</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">sweepname</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sweepname</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Sweep&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">setupname</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">setup_names</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">setups</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">setupname</span><span class="p">:</span>
                <span class="n">setupdata</span> <span class="o">=</span> <span class="n">i</span>
                <span class="k">for</span> <span class="n">sw</span> <span class="ow">in</span> <span class="n">setupdata</span><span class="o">.</span><span class="n">sweeps</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">sweepname</span> <span class="o">==</span> <span class="n">sw</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">messenger</span><span class="o">.</span><span class="n">add_warning_message</span><span class="p">(</span><span class="s2">&quot;Sweep </span><span class="si">{}</span><span class="s2"> already present. Please rename and retry&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sweepname</span><span class="p">))</span>
                        <span class="k">return</span> <span class="kc">False</span>
                <span class="n">sweepdata</span> <span class="o">=</span> <span class="n">setupdata</span><span class="o">.</span><span class="n">add_sweep</span><span class="p">(</span><span class="n">sweepname</span><span class="p">,</span> <span class="s2">&quot;Discrete&quot;</span><span class="p">)</span>
                <span class="n">sweepdata</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;RangeStart&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">freq</span>
                <span class="n">sweepdata</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;RangeEnd&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">freq</span>
                <span class="n">sweepdata</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;SaveSingleField&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">save_field</span>
                <span class="n">sweepdata</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;SaveFields&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">save_field</span>
                <span class="n">sweepdata</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;SaveRadFields&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">save_radiating_field</span>
                <span class="n">sweepdata</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;ExtrapToDC&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">sweepdata</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Discrete&quot;</span>
                <span class="n">sweepdata</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;RangeType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;SinglePoints&quot;</span>
                <span class="n">sweepdata</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_messenger</span><span class="o">.</span><span class="n">add_info_message</span><span class="p">(</span><span class="s2">&quot;Sweep Created Correctly&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">sweepname</span></div>


<div class="viewcode-block" id="Hfss.create_circuit_port_between_objects"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.create_circuit_port_between_objects">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">create_circuit_port_between_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">startobj</span><span class="p">,</span> <span class="n">endobject</span><span class="p">,</span> <span class="n">axisdir</span><span class="o">=</span><span class="s2">&quot;XYNeg&quot;</span><span class="p">,</span> <span class="n">impedance</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">portname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                            <span class="n">renorm</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">renorm_impedance</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">deemb</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function that Creates a Circuit port taking the closest edges of two objects.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        startobj :</span>
<span class="sd">            First object (starting object for integration line)</span>
<span class="sd">        endobject :</span>
<span class="sd">            Second object (ending object for integration line)</span>
<span class="sd">        axisdir :</span>
<span class="sd">            Position of port. it should be one of Application.AxisDir [XNeg, YNeg, ZNeg, XPos,YPos,ZPos] (Default value = &quot;XYNeg&quot;)</span>
<span class="sd">        impedance :</span>
<span class="sd">            Port Impedance (Default value = 50)</span>
<span class="sd">        portname :</span>
<span class="sd">            Port Name. (Default value = None)</span>
<span class="sd">        renorm :</span>
<span class="sd">            Boolean, Renormalize Mode (Default value = True)</span>
<span class="sd">        renorm_impedance :</span>
<span class="sd">            Float or str, Renormalize Impedance (Default value = 50)</span>
<span class="sd">        deemb :</span>
<span class="sd">            Boolean DEembed Port (Default value = False)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        type</span>
<span class="sd">            portname</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">does_object_exists</span><span class="p">(</span><span class="n">startobj</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">does_object_exists</span><span class="p">(</span><span class="n">endobject</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">messenger</span><span class="o">.</span><span class="n">add_error_message</span><span class="p">(</span><span class="s2">&quot;One or both objects doesn&#39;t exists. Check and retry&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;DrivenModal&quot;</span><span class="p">,</span> <span class="s2">&quot;DrivenTerminal&quot;</span><span class="p">,</span> <span class="s2">&quot;Transient Network&quot;</span><span class="p">]:</span>
            <span class="n">out</span><span class="p">,</span> <span class="n">parallel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">find_closest_edges</span><span class="p">(</span><span class="n">startobj</span><span class="p">,</span> <span class="n">endobject</span><span class="p">,</span> <span class="n">axisdir</span><span class="p">)</span>
            <span class="n">port_edges</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">portname</span><span class="p">:</span>
                <span class="n">portname</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Port&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">portname</span><span class="o">+</span><span class="s2">&quot;:1&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">get_excitations_name</span><span class="p">():</span>
                <span class="n">portname</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="n">portname</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_circuit_port</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">impedance</span><span class="p">,</span><span class="n">portname</span><span class="p">,</span> <span class="n">renorm</span><span class="p">,</span> <span class="n">deemb</span><span class="p">,</span><span class="n">renorm_impedance</span><span class="o">=</span><span class="n">renorm_impedance</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">portname</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Hfss.create_lumped_port_between_objects"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.create_lumped_port_between_objects">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">create_lumped_port_between_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">startobj</span><span class="p">,</span> <span class="n">endobject</span><span class="p">,</span> <span class="n">axisdir</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">impedance</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">portname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                           <span class="n">renorm</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">deemb</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">port_on_plane</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function that Creates a Lumped taking the closest edges of two objects.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        startobj :</span>
<span class="sd">            First object (starting object for integration line)</span>
<span class="sd">        endobject :</span>
<span class="sd">            Second object (ending object for integration line)</span>
<span class="sd">        axisdir :</span>
<span class="sd">            Position of port. it should be one of Application.AxisDir [XNeg, YNeg, ZNeg, XPos,YPos,ZPos] (Default value = 0)</span>
<span class="sd">        impedance :</span>
<span class="sd">            Port Impedance (Default value = 50)</span>
<span class="sd">        portname :</span>
<span class="sd">            Port Name. (Default value = None)</span>
<span class="sd">        renorm :</span>
<span class="sd">            Boolean, Renormalize Mode (Default value = True)</span>
<span class="sd">        deemb :</span>
<span class="sd">            Boolean DEembed Port (Default value = False)</span>
<span class="sd">        port_on_plane :</span>
<span class="sd">            Boolean. If True Source will be created on the Plane ortogonal to AxisDir (Default value = True)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        type</span>
<span class="sd">            portname</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">does_object_exists</span><span class="p">(</span><span class="n">startobj</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">does_object_exists</span><span class="p">(</span><span class="n">endobject</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">messenger</span><span class="o">.</span><span class="n">add_error_message</span><span class="p">(</span><span class="s2">&quot;One or both objects doesn&#39;t exists. Check and retry&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;DrivenModal&quot;</span><span class="p">,</span> <span class="s2">&quot;DrivenTerminal&quot;</span><span class="p">,</span> <span class="s2">&quot;Transient Network&quot;</span><span class="p">]:</span>
            <span class="n">sheet_name</span><span class="p">,</span> <span class="n">point0</span><span class="p">,</span> <span class="n">point1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">_create_sheet_from_object_closest_edge</span><span class="p">(</span><span class="n">startobj</span><span class="p">,</span> <span class="n">endobject</span><span class="p">,</span>
                                                                                             <span class="n">axisdir</span><span class="p">,</span> <span class="n">port_on_plane</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">portname</span><span class="p">:</span>
                <span class="n">portname</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Port&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">portname</span><span class="o">+</span><span class="s2">&quot;:1&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">get_excitations_name</span><span class="p">():</span>
                <span class="n">portname</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="n">portname</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="o">==</span> <span class="s2">&quot;DrivenModal&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_create_lumped_driven</span><span class="p">(</span><span class="n">sheet_name</span><span class="p">,</span> <span class="n">point0</span><span class="p">,</span> <span class="n">point1</span><span class="p">,</span> <span class="n">impedance</span><span class="p">,</span> <span class="n">portname</span><span class="p">,</span><span class="n">renorm</span><span class="p">,</span> <span class="n">deemb</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">faces</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">get_object_faces</span><span class="p">(</span><span class="n">sheet_name</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_create_port_terminal</span><span class="p">(</span><span class="n">faces</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">endobject</span><span class="p">,</span> <span class="n">portname</span><span class="p">,</span> <span class="n">iswaveport</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">portname</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Hfss.create_voltage_source_from_objects"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.create_voltage_source_from_objects">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">create_voltage_source_from_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">startobj</span><span class="p">,</span> <span class="n">endobject</span><span class="p">,</span> <span class="n">axisdir</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sourcename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">source_on_plane</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function that Creates a Voltage Source taking the closest edges of two objects.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        startobj :</span>
<span class="sd">            First object (starting object for integration line)</span>
<span class="sd">        endobject :</span>
<span class="sd">            Second object (ending object for integration line)</span>
<span class="sd">        axisdir :</span>
<span class="sd">            Position of VS. it should be one of Application.AxisDir [XNeg, YNeg, ZNeg, XPos,YPos,ZPos] (Default value = 0)</span>
<span class="sd">        sourcename :</span>
<span class="sd">            Optional Source Name (Default value = None)</span>
<span class="sd">        source_on_plane :</span>
<span class="sd">            Boolean. If True Source will be created on the Plane ortogonal to AxisDir (Default value = True)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        type</span>
<span class="sd">            sourcename</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">does_object_exists</span><span class="p">(</span><span class="n">startobj</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">does_object_exists</span><span class="p">(</span><span class="n">endobject</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">messenger</span><span class="o">.</span><span class="n">add_error_message</span><span class="p">(</span><span class="s2">&quot;One or both objects doesn&#39;t exists. Check and retry&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;DrivenModal&quot;</span><span class="p">,</span> <span class="s2">&quot;DrivenTerminal&quot;</span><span class="p">,</span> <span class="s2">&quot;Transient Network&quot;</span><span class="p">]:</span>
            <span class="n">sheet_name</span><span class="p">,</span> <span class="n">point0</span><span class="p">,</span> <span class="n">point1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">_create_sheet_from_object_closest_edge</span><span class="p">(</span><span class="n">startobj</span><span class="p">,</span><span class="n">endobject</span><span class="p">,</span><span class="n">axisdir</span><span class="p">,</span> <span class="n">source_on_plane</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">sourcename</span><span class="p">:</span>
                <span class="n">sourcename</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Voltage&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">sourcename</span><span class="o">+</span><span class="s2">&quot;:1&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">get_excitations_name</span><span class="p">():</span>
                <span class="n">sourcename</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="n">sourcename</span><span class="p">)</span>
            <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_source_excitation</span><span class="p">(</span><span class="n">sheet_name</span><span class="p">,</span> <span class="n">point0</span><span class="p">,</span> <span class="n">point1</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">,</span> <span class="n">sourcetype</span><span class="o">=</span><span class="s2">&quot;Voltage&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">status</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">sourcename</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Hfss.create_current_source_from_objects"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.create_current_source_from_objects">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">create_current_source_from_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">startobj</span><span class="p">,</span> <span class="n">endobject</span><span class="p">,</span> <span class="n">axisdir</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sourcename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">source_on_plane</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function that Creates a Voltage Source taking the closest edges of two objects.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        startobj :</span>
<span class="sd">            First object (starting object for integration line)</span>
<span class="sd">        endobject :</span>
<span class="sd">            Second object (ending object for integration line)</span>
<span class="sd">        axisdir :</span>
<span class="sd">            Position of VS. it should be one of Application.AxisDir [XNeg, YNeg, ZNeg, XPos,YPos,ZPos] (Default value = 0)</span>
<span class="sd">        sourcename :</span>
<span class="sd">            Optional Source Name (Default value = None)</span>
<span class="sd">        source_on_plane :</span>
<span class="sd">            Boolean. If True Source will be created on the Plane ortogonal to AxisDir (Default value = True)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        type</span>
<span class="sd">            sourcename</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">does_object_exists</span><span class="p">(</span><span class="n">startobj</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">does_object_exists</span><span class="p">(</span><span class="n">endobject</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">messenger</span><span class="o">.</span><span class="n">add_error_message</span><span class="p">(</span><span class="s2">&quot;One or both objects doesn&#39;t exists. Check and retry&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;DrivenModal&quot;</span><span class="p">,</span> <span class="s2">&quot;DrivenTerminal&quot;</span><span class="p">,</span> <span class="s2">&quot;Transient Network&quot;</span><span class="p">]:</span>
            <span class="n">sheet_name</span><span class="p">,</span> <span class="n">point0</span><span class="p">,</span> <span class="n">point1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">_create_sheet_from_object_closest_edge</span><span class="p">(</span><span class="n">startobj</span><span class="p">,</span><span class="n">endobject</span><span class="p">,</span><span class="n">axisdir</span><span class="p">,</span> <span class="n">source_on_plane</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">sourcename</span><span class="p">:</span>
                <span class="n">sourcename</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Current&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">sourcename</span><span class="o">+</span><span class="s2">&quot;:1&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">get_excitations_name</span><span class="p">():</span>
                <span class="n">sourcename</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="n">sourcename</span><span class="p">)</span>
            <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_source_excitation</span><span class="p">(</span><span class="n">sheet_name</span><span class="p">,</span> <span class="n">point0</span><span class="p">,</span> <span class="n">point1</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">,</span> <span class="n">sourcetype</span><span class="o">=</span><span class="s2">&quot;Current&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">status</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">sourcename</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Hfss.create_source_excitation"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.create_source_excitation">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">create_source_excitation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheet_name</span><span class="p">,</span> <span class="n">point1</span><span class="p">,</span> <span class="n">point2</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">,</span> <span class="n">sourcetype</span><span class="o">=</span><span class="s2">&quot;Voltage&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sheet_name :</span>
<span class="sd">            </span>
<span class="sd">        point1 :</span>
<span class="sd">            </span>
<span class="sd">        point2 :</span>
<span class="sd">            </span>
<span class="sd">        sourcename :</span>
<span class="sd">            </span>
<span class="sd">        sourcetype :</span>
<span class="sd">             (Default value = &quot;Voltage&quot;)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">props</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">({</span><span class="s2">&quot;Objects&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">sheet_name</span><span class="p">],</span>
               <span class="s2">&quot;Direction&quot;</span><span class="p">:</span><span class="n">OrderedDict</span><span class="p">({</span><span class="s2">&quot;Start&quot;</span><span class="p">:</span> <span class="n">point1</span><span class="p">,</span> <span class="s2">&quot;End&quot;</span><span class="p">:</span> <span class="n">point2</span><span class="p">})})</span>

        <span class="n">bound</span> <span class="o">=</span> <span class="n">BoundaryObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">,</span> <span class="n">props</span><span class="p">,</span> <span class="n">sourcetype</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bound</span><span class="o">.</span><span class="n">create</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bound</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">bound</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Hfss.create_wave_port_between_objects"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.create_wave_port_between_objects">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">create_wave_port_between_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">startobj</span><span class="p">,</span> <span class="n">endobject</span><span class="p">,</span> <span class="n">axisdir</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">impedance</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">nummodes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">portname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                         <span class="n">renorm</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">deembed_dist</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">port_on_plane</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">add_pec_cap</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function that Creates a Waveport taking the closest edges of two objects.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        startobj :</span>
<span class="sd">            First object (starting object for integration line)</span>
<span class="sd">        endobject :</span>
<span class="sd">            Second object (ending object for integration line)</span>
<span class="sd">        axisdir :</span>
<span class="sd">            Position of port. it should be one of Application.AxisDir [XNeg, YNeg, ZNeg, XPos,YPos,ZPos] (Default value = 0)</span>
<span class="sd">        impedance :</span>
<span class="sd">            Port Impedance (Default value = 50)</span>
<span class="sd">        nummodes :</span>
<span class="sd">            Number of Modes (Default value = 1)</span>
<span class="sd">        portname :</span>
<span class="sd">            Port Name. (Default value = None)</span>
<span class="sd">        renorm :</span>
<span class="sd">            Boolean, Renormalize Mode (Default value = True)</span>
<span class="sd">        deembed_dist :</span>
<span class="sd">            Deembed Distance. Float in model units (default mm). if 0 Deembed is disabled</span>
<span class="sd">        port_on_plane :</span>
<span class="sd">            Boolean. If True Port will be created on the Plane ortogonal to AxisDir (Default value = True)</span>
<span class="sd">        add_pec_cap :</span>
<span class="sd">             (Default value = False)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class: BoundaryObject</span>
<span class="sd">            Port Name</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">does_object_exists</span><span class="p">(</span><span class="n">startobj</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">does_object_exists</span><span class="p">(</span><span class="n">endobject</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">messenger</span><span class="o">.</span><span class="n">add_error_message</span><span class="p">(</span><span class="s2">&quot;One or both objects doesn&#39;t exists. Check and retry&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;DrivenModal&quot;</span><span class="p">,</span> <span class="s2">&quot;DrivenTerminal&quot;</span><span class="p">,</span> <span class="s2">&quot;Transient Network&quot;</span><span class="p">]:</span>
            <span class="n">sheet_name</span><span class="p">,</span> <span class="n">point0</span><span class="p">,</span> <span class="n">point1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">_create_sheet_from_object_closest_edge</span><span class="p">(</span><span class="n">startobj</span><span class="p">,</span><span class="n">endobject</span><span class="p">,</span><span class="n">axisdir</span><span class="p">,</span> <span class="n">port_on_plane</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">add_pec_cap</span><span class="p">:</span>
                <span class="n">dist</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">points_distance</span><span class="p">(</span><span class="n">point0</span><span class="p">,</span> <span class="n">point1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_create_pec_cap</span><span class="p">(</span><span class="n">sheet_name</span><span class="p">,</span> <span class="n">axisdir</span><span class="p">,</span> <span class="n">dist</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">portname</span><span class="p">:</span>
                <span class="n">portname</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Port&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">portname</span><span class="o">+</span><span class="s2">&quot;:1&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">get_excitations_name</span><span class="p">():</span>
                <span class="n">portname</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="n">portname</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="o">==</span> <span class="s2">&quot;DrivenModal&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_waveport_driven</span><span class="p">(</span><span class="n">sheet_name</span><span class="p">,</span> <span class="n">point0</span><span class="p">,</span> <span class="n">point1</span><span class="p">,</span> <span class="n">impedance</span><span class="p">,</span> <span class="n">portname</span><span class="p">,</span> <span class="n">renorm</span><span class="p">,</span> <span class="n">nummodes</span><span class="p">,</span> <span class="n">deembed_dist</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">faces</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">get_object_faces</span><span class="p">(</span><span class="n">sheet_name</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_port_terminal</span><span class="p">(</span><span class="n">faces</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">endobject</span><span class="p">,</span> <span class="n">portname</span><span class="p">,</span> <span class="n">iswaveport</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span></div>

    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">_create_pec_cap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheet_name</span><span class="p">,</span> <span class="n">axisdir</span><span class="p">,</span> <span class="n">pecthick</span><span class="p">):</span>
        <span class="n">vector</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">axisdir</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">vector</span><span class="p">[</span><span class="nb">divmod</span><span class="p">(</span><span class="n">axisdir</span><span class="p">,</span> <span class="mi">3</span><span class="p">)[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="o">-</span><span class="n">pecthick</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">vector</span><span class="p">[</span><span class="nb">divmod</span><span class="p">(</span><span class="n">axisdir</span><span class="p">,</span> <span class="mi">3</span><span class="p">)[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">pecthick</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="n">status</span><span class="p">,</span> <span class="n">pecobj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">duplicate_along_line</span><span class="p">(</span><span class="n">sheet_name</span><span class="p">,</span> <span class="n">vector</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">thicken_sheet</span><span class="p">(</span><span class="n">pecobj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pecthick</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assignmaterial</span><span class="p">(</span><span class="n">pecobj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;pec&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

<div class="viewcode-block" id="Hfss.create_wave_port_microstrip_between_objects"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.create_wave_port_microstrip_between_objects">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">create_wave_port_microstrip_between_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">startobj</span><span class="p">,</span> <span class="n">endobject</span><span class="p">,</span> <span class="n">axisdir</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">impedance</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">nummodes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">portname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                         <span class="n">renorm</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">deembed_dist</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vfactor</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">hfactor</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function that Creates a Waveport taking the closest edges of two objects.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        startobj :</span>
<span class="sd">            First object (starting object for integration line)</span>
<span class="sd">        endobject :</span>
<span class="sd">            Second object (ending object for integration line)</span>
<span class="sd">        axisdir :</span>
<span class="sd">            Position of port. it should be one of Application.AxisDir [XNeg, YNeg, ZNeg, XPos,YPos,ZPos] (Default value = 0)</span>
<span class="sd">        impedance :</span>
<span class="sd">            Port Impedance (Default value = 50)</span>
<span class="sd">        nummodes :</span>
<span class="sd">            Number of Modes (Default value = 1)</span>
<span class="sd">        portname :</span>
<span class="sd">            Port Name. (Default value = None)</span>
<span class="sd">        renorm :</span>
<span class="sd">            Boolean, Renormalize Mode (Default value = True)</span>
<span class="sd">        deembed_dist :</span>
<span class="sd">            Deembed Distance. Float in model units (default mm). if 0 Deembed is disabled</span>
<span class="sd">        vfactor :</span>
<span class="sd">            Port Vertical Factor (Default value = 3)</span>
<span class="sd">        hfactor :</span>
<span class="sd">            Port HorizontalFactor (Default value = 5)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class: BoundaryObject</span>
<span class="sd">            Port Name</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">does_object_exists</span><span class="p">(</span><span class="n">startobj</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">does_object_exists</span><span class="p">(</span><span class="n">endobject</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">messenger</span><span class="o">.</span><span class="n">add_error_message</span><span class="p">(</span><span class="s2">&quot;One or both objects doesn&#39;t exists. Check and retry&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;DrivenModal&quot;</span><span class="p">,</span> <span class="s2">&quot;DrivenTerminal&quot;</span><span class="p">,</span> <span class="s2">&quot;Transient Network&quot;</span><span class="p">]:</span>
            <span class="n">sheet_name</span><span class="p">,</span> <span class="n">point0</span><span class="p">,</span> <span class="n">point1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">_create_microstrip_sheet_from_object_closest_edge</span><span class="p">(</span><span class="n">startobj</span><span class="p">,</span><span class="n">endobject</span><span class="p">,</span><span class="n">axisdir</span><span class="p">,</span> <span class="n">vfactor</span><span class="p">,</span> <span class="n">hfactor</span><span class="p">)</span>
            <span class="n">dist</span> <span class="o">=</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">points_distance</span><span class="p">(</span><span class="n">point0</span><span class="p">,</span> <span class="n">point1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_create_pec_cap</span><span class="p">(</span><span class="n">sheet_name</span><span class="p">,</span> <span class="n">axisdir</span><span class="p">,</span><span class="n">dist</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">portname</span><span class="p">:</span>
                <span class="n">portname</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Port&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">portname</span><span class="o">+</span><span class="s2">&quot;:1&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">get_excitations_name</span><span class="p">():</span>
                <span class="n">portname</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="n">portname</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="o">==</span> <span class="s2">&quot;DrivenModal&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_waveport_driven</span><span class="p">(</span><span class="n">sheet_name</span><span class="p">,</span> <span class="n">point0</span><span class="p">,</span> <span class="n">point1</span><span class="p">,</span> <span class="n">impedance</span><span class="p">,</span> <span class="n">portname</span><span class="p">,</span> <span class="n">renorm</span><span class="p">,</span> <span class="n">nummodes</span><span class="p">,</span> <span class="n">deembed_dist</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">faces</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">get_object_faces</span><span class="p">(</span><span class="n">sheet_name</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_port_terminal</span><span class="p">(</span><span class="n">faces</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">endobject</span><span class="p">,</span> <span class="n">portname</span><span class="p">,</span> <span class="n">iswaveport</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Hfss.create_perfecte_from_objects"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.create_perfecte_from_objects">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">create_perfecte_from_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">startobj</span><span class="p">,</span> <span class="n">endobject</span><span class="p">,</span> <span class="n">axisdir</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sourcename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_infinite_gnd</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bound_on_plane</span><span class="o">=</span><span class="kc">True</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function that Creates a Perfect E  taking the closest edges of two objects.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        startobj :</span>
<span class="sd">            First object (starting object for integration line)</span>
<span class="sd">        endobject :</span>
<span class="sd">            Second object (ending object for integration line)</span>
<span class="sd">        axisdir :</span>
<span class="sd">            Position of port. it should be one of Application.AxisDir [XNeg, YNeg, ZNeg, XPos,YPos,ZPos] (Default value = 0)</span>
<span class="sd">        sourcename :</span>
<span class="sd">            Perfect E Name. (Default value = None)</span>
<span class="sd">        bound_on_plane :</span>
<span class="sd">            Boolean. If True PerfectE will be created on the Plane ortogonal to AxisDir (Default value = True)</span>
<span class="sd">        is_infinite_gnd :</span>
<span class="sd">             (Default value = False)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class: BoundaryObject</span>
<span class="sd">            boundary object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">does_object_exists</span><span class="p">(</span><span class="n">startobj</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">does_object_exists</span><span class="p">(</span><span class="n">endobject</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">messenger</span><span class="o">.</span><span class="n">add_error_message</span><span class="p">(</span><span class="s2">&quot;One or both objects doesn&#39;t exists. Check and retry&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;DrivenModal&quot;</span><span class="p">,</span> <span class="s2">&quot;DrivenTerminal&quot;</span><span class="p">,</span> <span class="s2">&quot;Transient Network&quot;</span><span class="p">]:</span>
            <span class="n">sheet_name</span><span class="p">,</span> <span class="n">point0</span><span class="p">,</span> <span class="n">point1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">_create_sheet_from_object_closest_edge</span><span class="p">(</span><span class="n">startobj</span><span class="p">,</span><span class="n">endobject</span><span class="p">,</span><span class="n">axisdir</span><span class="p">,</span> <span class="n">bound_on_plane</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">sourcename</span><span class="p">:</span>
                <span class="n">sourcename</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;PerfE&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">sourcename</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">get_boundaries_name</span><span class="p">():</span>
                <span class="n">sourcename</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="n">sourcename</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_boundary</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BoundaryType</span><span class="o">.</span><span class="n">PerfectE</span><span class="p">,</span> <span class="n">sheet_name</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">,</span> <span class="n">is_infinite_gnd</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Hfss.create_perfecth_from_objects"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.create_perfecth_from_objects">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">create_perfecth_from_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">startobj</span><span class="p">,</span> <span class="n">endobject</span><span class="p">,</span> <span class="n">axisdir</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sourcename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">bound_on_plane</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function that Creates a Perfect H  taking the closest edges of two objects.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        startobj :</span>
<span class="sd">            First object (starting object for integration line)</span>
<span class="sd">        endobject :</span>
<span class="sd">            Second object (ending object for integration line)</span>
<span class="sd">        axisdir :</span>
<span class="sd">            Position of port. it should be one of Application.AxisDir [XNeg, YNeg, ZNeg, XPos,YPos,ZPos] (Default value = 0)</span>
<span class="sd">        sourcename :</span>
<span class="sd">            Perfect H Name. (Default value = None)</span>
<span class="sd">        bound_on_plane :</span>
<span class="sd">            Boolean. If True PerfectH will be created on the Plane ortogonal to AxisDir (Default value = True)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class: BoundaryObject</span>
<span class="sd">            Boundary Object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">does_object_exists</span><span class="p">(</span><span class="n">startobj</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">does_object_exists</span><span class="p">(</span><span class="n">endobject</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">messenger</span><span class="o">.</span><span class="n">add_error_message</span><span class="p">(</span><span class="s2">&quot;One or both objects doesn&#39;t exists. Check and retry&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;DrivenModal&quot;</span><span class="p">,</span> <span class="s2">&quot;DrivenTerminal&quot;</span><span class="p">,</span> <span class="s2">&quot;Transient Network&quot;</span><span class="p">]:</span>
            <span class="n">sheet_name</span><span class="p">,</span> <span class="n">point0</span><span class="p">,</span> <span class="n">point1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">_create_sheet_from_object_closest_edge</span><span class="p">(</span><span class="n">startobj</span><span class="p">,</span><span class="n">endobject</span><span class="p">,</span><span class="n">axisdir</span><span class="p">,</span> <span class="n">bound_on_plane</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">sourcename</span><span class="p">:</span>
                <span class="n">sourcename</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;PerfH&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">sourcename</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">get_boundaries_name</span><span class="p">():</span>
                <span class="n">sourcename</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="n">sourcename</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_boundary</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BoundaryType</span><span class="o">.</span><span class="n">PerfectH</span><span class="p">,</span> <span class="n">sheet_name</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="Hfss.SARSetup"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.SARSetup">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">SARSetup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Tissue_object_List_ID</span><span class="p">,</span> <span class="n">TissueMass</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">MaterialDensity</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="n">voxel_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Average_SAR_method</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set SAR Settings</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        Tissue_object_List_ID :</span>
<span class="sd">            33</span>
<span class="sd">        TissueMass :</span>
<span class="sd">            param MaterialDensity: (Default value = 1)</span>
<span class="sd">        voxel_size :</span>
<span class="sd">            param Average_SAR_method: (Default value = 1)</span>
<span class="sd">        MaterialDensity :</span>
<span class="sd">             (Default value = 1)</span>
<span class="sd">        Average_SAR_method :</span>
<span class="sd">             (Default value = 0)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">odesign</span><span class="o">.</span><span class="n">SARSetup</span><span class="p">(</span><span class="n">TissueMass</span><span class="p">,</span> <span class="n">MaterialDensity</span><span class="p">,</span> <span class="n">Tissue_object_List_ID</span><span class="p">,</span> <span class="n">voxel_size</span><span class="p">,</span> <span class="n">Average_SAR_method</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Hfss.create_open_region"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.create_open_region">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">create_open_region</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Frequency</span><span class="o">=</span><span class="s2">&quot;1GHz&quot;</span><span class="p">,</span> <span class="n">Boundary</span><span class="o">=</span><span class="s2">&quot;Radiation&quot;</span><span class="p">,</span> <span class="n">ApplyInfiniteGP</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">GPAXis</span><span class="o">=</span><span class="s2">&quot;-z&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create an open region on the active Editor</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        Frequency :</span>
<span class="sd">            Frequency with Units (Default value = &quot;1GHz&quot;)</span>
<span class="sd">        Boundary :</span>
<span class="sd">            Boundary Type. Default &quot;Radition&quot;</span>
<span class="sd">        ApplyInfiniteGP :</span>
<span class="sd">            Bool to apply infinite Ground Plane (Default value = False)</span>
<span class="sd">        GPAXis :</span>
<span class="sd">             (Default value = &quot;-z&quot;)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">vars</span><span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;NAME:Settings&quot;</span><span class="p">,</span>
                <span class="s2">&quot;OpFreq:=&quot;</span>	<span class="p">,</span> <span class="n">Frequency</span><span class="p">,</span>
                <span class="s2">&quot;Boundary:=&quot;</span>		<span class="p">,</span> <span class="n">Boundary</span><span class="p">,</span>
                <span class="s2">&quot;ApplyInfiniteGP:=&quot;</span>	<span class="p">,</span> <span class="n">ApplyInfiniteGP</span>
            <span class="p">]</span>
        <span class="k">if</span> <span class="n">ApplyInfiniteGP</span><span class="p">:</span>
            <span class="nb">vars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Direction:=&quot;</span><span class="p">)</span>
            <span class="nb">vars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">GPAXis</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">omodelsetup</span><span class="o">.</span><span class="n">CreateOpenRegion</span><span class="p">(</span><span class="nb">vars</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Hfss.create_lumped_rlc_between_objects"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.create_lumped_rlc_between_objects">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">create_lumped_rlc_between_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">startobj</span><span class="p">,</span> <span class="n">endobject</span><span class="p">,</span> <span class="n">axisdir</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sourcename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rlctype</span><span class="o">=</span><span class="s2">&quot;Parallel&quot;</span><span class="p">,</span>
                                          <span class="n">Rvalue</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Lvalue</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Cvalue</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bound_on_plane</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function that Creates a Perfect H  taking the closest edges of two objects.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        startobj :</span>
<span class="sd">            First object (starting object for integration line)</span>
<span class="sd">        endobject :</span>
<span class="sd">            Second object (ending object for integration line)</span>
<span class="sd">        axisdir :</span>
<span class="sd">            Position of port. it should be one of Application.AxisDir [XNeg, YNeg, ZNeg, XPos,YPos,ZPos] (Default value = 0)</span>
<span class="sd">        sourcename :</span>
<span class="sd">            Perfect H Name. (Default value = None)</span>
<span class="sd">        Cvalue :</span>
<span class="sd">            Capacitance Value in F. None to disable (Default value = None)</span>
<span class="sd">        Lvalue :</span>
<span class="sd">            Inductacnce Value in H. None to disable (Default value = None)</span>
<span class="sd">        rlctype :</span>
<span class="sd">            Parallel&quot; or &quot;Series&quot; (Default value = &quot;Parallel&quot;)</span>
<span class="sd">        Rvalue :</span>
<span class="sd">            Resistance Value in Ohm. None to disable (Default value = None)</span>
<span class="sd">        bound_on_plane :</span>
<span class="sd">            Boolean. If True Boundary will be created on the Plane ortogonal to AxisDir (Default value = True)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class: BoundaryObject</span>
<span class="sd">            Boundary Name</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">does_object_exists</span><span class="p">(</span><span class="n">startobj</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">does_object_exists</span><span class="p">(</span><span class="n">endobject</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">messenger</span><span class="o">.</span><span class="n">add_error_message</span><span class="p">(</span><span class="s2">&quot;One or both objects doesn&#39;t exists. Check and retry&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;DrivenModal&quot;</span><span class="p">,</span> <span class="s2">&quot;DrivenTerminal&quot;</span><span class="p">,</span> <span class="s2">&quot;Transient Network&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span><span class="n">Rvalue</span> <span class="ow">or</span> <span class="n">Lvalue</span> <span class="ow">or</span> <span class="n">Cvalue</span><span class="p">):</span>
            <span class="n">sheet_name</span><span class="p">,</span> <span class="n">point0</span><span class="p">,</span> <span class="n">point1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">_create_sheet_from_object_closest_edge</span><span class="p">(</span><span class="n">startobj</span><span class="p">,</span><span class="n">endobject</span><span class="p">,</span><span class="n">axisdir</span><span class="p">,</span> <span class="n">bound_on_plane</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">sourcename</span><span class="p">:</span>
                <span class="n">sourcename</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Lump&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">sourcename</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">get_boundaries_name</span><span class="p">():</span>
                <span class="n">sourcename</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="n">sourcename</span><span class="p">)</span>
            <span class="n">start</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">model_units</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">point0</span><span class="p">]</span>
            <span class="n">stop</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">model_units</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">point1</span><span class="p">]</span>

            <span class="n">props</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="n">props</span><span class="p">[</span><span class="s2">&quot;Objects&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">sheet_name</span><span class="p">]</span>
            <span class="n">props</span><span class="p">[</span><span class="s2">&quot;CurrentLine&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">({</span><span class="s2">&quot;Start&quot;</span><span class="p">:</span><span class="n">start</span><span class="p">,</span> <span class="s2">&quot;End&quot;</span><span class="p">:</span> <span class="n">stop</span><span class="p">})</span>
            <span class="n">props</span><span class="p">[</span><span class="s2">&quot;RLC Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">rlctype</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">Rvalue</span><span class="p">:</span>
                <span class="n">props</span><span class="p">[</span><span class="s2">&quot;UseResist&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">props</span><span class="p">[</span><span class="s2">&quot;Resistance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Rvalue</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;ohm&quot;</span>
            <span class="k">if</span> <span class="n">Lvalue</span><span class="p">:</span>
                <span class="n">props</span><span class="p">[</span><span class="s2">&quot;UseInduct&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">props</span><span class="p">[</span><span class="s2">&quot;Inductance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Lvalue</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;H&quot;</span>
            <span class="k">if</span> <span class="n">Cvalue</span><span class="p">:</span>
                <span class="n">props</span><span class="p">[</span><span class="s2">&quot;UseCap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">props</span><span class="p">[</span><span class="s2">&quot;Capacitance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Cvalue</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;F&quot;</span>
            <span class="n">bound</span> <span class="o">=</span> <span class="n">BoundaryObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">,</span> <span class="n">props</span><span class="p">,</span> <span class="s2">&quot;LumpedRLC&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">bound</span><span class="o">.</span><span class="n">create</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bound</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">bound</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Hfss.create_impedance_between_objects"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.create_impedance_between_objects">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">create_impedance_between_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">startobj</span><span class="p">,</span> <span class="n">endobject</span><span class="p">,</span> <span class="n">axisdir</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sourcename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">resistance</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">reactance</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">is_infground</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bound_on_plane</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function that Creates an impedance taking the closest edges of two objects.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        startobj :</span>
<span class="sd">            First object (starting object for integration line)</span>
<span class="sd">        endobject :</span>
<span class="sd">            Second object (ending object for integration line)</span>
<span class="sd">        axisdir :</span>
<span class="sd">            Position of impedance. it should be one of Application.AxisDir [XNeg, YNeg, ZNeg, XPos,YPos,ZPos] (Default value = 0)</span>
<span class="sd">        sourcename :</span>
<span class="sd">            impedance Name. (Default value = None)</span>
<span class="sd">        resistance :</span>
<span class="sd">            Resistance Value in Ohm. None to disable (Default value = 50)</span>
<span class="sd">        reactance :</span>
<span class="sd">            Reactance Value in Ohm. None to disable (Default value = 0)</span>
<span class="sd">        bound_on_plane :</span>
<span class="sd">            Boolean. If True Impdedance will be created on the Plane ortogonal to AxisDir (Default value = True)</span>
<span class="sd">        is_infground :</span>
<span class="sd">             (Default value = False)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class: BoundaryObject</span>
<span class="sd">            Boundary Name</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">does_object_exists</span><span class="p">(</span><span class="n">startobj</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">does_object_exists</span><span class="p">(</span><span class="n">endobject</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">messenger</span><span class="o">.</span><span class="n">add_error_message</span><span class="p">(</span><span class="s2">&quot;One or both objects doesn&#39;t exists. Check and retry&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;DrivenModal&quot;</span><span class="p">,</span> <span class="s2">&quot;DrivenTerminal&quot;</span><span class="p">,</span> <span class="s2">&quot;Transient Network&quot;</span><span class="p">]</span> <span class="p">:</span>
            <span class="n">sheet_name</span><span class="p">,</span> <span class="n">point0</span><span class="p">,</span> <span class="n">point1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">_create_sheet_from_object_closest_edge</span><span class="p">(</span><span class="n">startobj</span><span class="p">,</span> <span class="n">endobject</span><span class="p">,</span> <span class="n">axisdir</span><span class="p">,</span> <span class="n">bound_on_plane</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">sourcename</span><span class="p">:</span>
                <span class="n">sourcename</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Imped&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">sourcename</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">get_boundaries_name</span><span class="p">():</span>
                <span class="n">sourcename</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="n">sourcename</span><span class="p">)</span>
            <span class="n">props</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">({</span><span class="s2">&quot;Objects&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">sheet_name</span><span class="p">],</span> <span class="s2">&quot;Resistance&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">resistance</span><span class="p">),</span> <span class="s2">&quot;Reactance&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">reactance</span><span class="p">),</span>
                                 <span class="s2">&quot;InfGroundPlane&quot;</span><span class="p">:</span> <span class="n">is_infground</span><span class="p">})</span>
            <span class="n">bound</span> <span class="o">=</span> <span class="n">BoundaryObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">,</span> <span class="n">props</span><span class="p">,</span> <span class="s1">&#39;Impedance&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">bound</span><span class="o">.</span><span class="n">create</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bound</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">bound</span>

        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Hfss.create_boundary"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.create_boundary">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">create_boundary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boundary_type</span><span class="o">=</span><span class="n">BoundaryType</span><span class="o">.</span><span class="n">PerfectE</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">boundary_name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">is_infinite_gnd</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a Boundary given specific inputs</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        boundary_type :</span>
<span class="sd">            BoundaryType object (PerfectE, PerfectH, Aperture, Radiation) (Default value = BoundaryType.PerfectE)</span>
<span class="sd">        sheet_name :</span>
<span class="sd">            Sheet Name. It can be an integer (facesID), a string (sheet) or a list of previous (Default value = None)</span>
<span class="sd">        boundary_name :</span>
<span class="sd">            Boundary Name (Default value = &quot;&quot;)</span>
<span class="sd">        is_infinite_gnd :</span>
<span class="sd">            Boolean (Default value = False)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class: BoundaryObject</span>
<span class="sd">            Boundary Object if successful</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">props</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">sheet_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">_convert_list_to_ids</span><span class="p">(</span><span class="n">sheet_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">sheet_name</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">sheet_name</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="n">props</span><span class="p">[</span><span class="s2">&quot;Objects&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sheet_name</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">props</span><span class="p">[</span><span class="s2">&quot;Faces&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sheet_name</span>

        <span class="k">if</span> <span class="n">boundary_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">BoundaryType</span><span class="o">.</span><span class="n">PerfectE</span><span class="p">:</span>
            <span class="n">props</span><span class="p">[</span><span class="s1">&#39;InfGroundPlane&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">is_infinite_gnd</span>
            <span class="n">bound</span> <span class="o">=</span> <span class="n">BoundaryObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boundary_name</span><span class="p">,</span> <span class="n">props</span><span class="p">,</span> <span class="s1">&#39;PerfectE&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">boundary_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">BoundaryType</span><span class="o">.</span><span class="n">PerfectH</span><span class="p">:</span>
            <span class="n">bound</span> <span class="o">=</span> <span class="n">BoundaryObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boundary_name</span><span class="p">,</span> <span class="n">props</span><span class="p">,</span> <span class="s1">&#39;PerfectH&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">boundary_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">BoundaryType</span><span class="o">.</span><span class="n">Aperture</span><span class="p">:</span>
            <span class="n">bound</span> <span class="o">=</span> <span class="n">BoundaryObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boundary_name</span><span class="p">,</span> <span class="n">props</span><span class="p">,</span> <span class="s1">&#39;Aperture&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">boundary_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">BoundaryType</span><span class="o">.</span><span class="n">Radiation</span><span class="p">:</span>
            <span class="n">props</span><span class="p">[</span><span class="s1">&#39;IsFssReference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">props</span><span class="p">[</span><span class="s1">&#39;IsForPML&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">bound</span> <span class="o">=</span> <span class="n">BoundaryObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boundary_name</span><span class="p">,</span> <span class="n">props</span><span class="p">,</span> <span class="s1">&#39;Radiation&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">bound</span><span class="o">.</span><span class="n">create</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bound</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">bound</span>
        <span class="k">return</span> <span class="kc">False</span></div>

    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">_get_reference_and_integration_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheet</span><span class="p">,</span> <span class="n">axisdir</span><span class="p">):</span>
        <span class="n">objID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">oeditor</span><span class="o">.</span><span class="n">GetFaceIDs</span><span class="p">(</span><span class="n">sheet</span><span class="p">)</span>
        <span class="n">face_edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">get_face_edges</span><span class="p">(</span><span class="n">objID</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">mid_points</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">get_edge_midpoint</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">face_edges</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">axisdir</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">min_point</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1e6</span><span class="p">,</span> <span class="mf">1e6</span><span class="p">,</span> <span class="mf">1e6</span><span class="p">]</span>
            <span class="n">max_point</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">1e6</span><span class="p">,</span> <span class="o">-</span><span class="mf">1e6</span><span class="p">,</span> <span class="o">-</span><span class="mf">1e6</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">mid_points</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">el</span><span class="p">[</span><span class="n">axisdir</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">min_point</span><span class="p">[</span><span class="n">axisdir</span><span class="p">]:</span>
                    <span class="n">min_point</span> <span class="o">=</span> <span class="n">el</span>
                <span class="k">if</span> <span class="n">el</span><span class="p">[</span><span class="n">axisdir</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">max_point</span><span class="p">[</span><span class="n">axisdir</span><span class="p">]:</span>
                    <span class="n">max_point</span> <span class="o">=</span> <span class="n">el</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">min_point</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">1e6</span><span class="p">,</span> <span class="o">-</span><span class="mf">1e6</span><span class="p">,</span> <span class="o">-</span><span class="mf">1e6</span><span class="p">]</span>
            <span class="n">max_point</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1e6</span><span class="p">,</span> <span class="mf">1e6</span><span class="p">,</span> <span class="mf">1e6</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">mid_points</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">el</span><span class="p">[</span><span class="n">axisdir</span> <span class="o">-</span> <span class="mi">3</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">min_point</span><span class="p">[</span><span class="n">axisdir</span> <span class="o">-</span> <span class="mi">3</span><span class="p">]:</span>
                    <span class="n">min_point</span> <span class="o">=</span> <span class="n">el</span>
                <span class="k">if</span> <span class="n">el</span><span class="p">[</span><span class="n">axisdir</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">max_point</span><span class="p">[</span><span class="n">axisdir</span><span class="o">-</span><span class="mi">3</span><span class="p">]:</span>
                    <span class="n">max_point</span> <span class="o">=</span> <span class="n">el</span>

        <span class="n">refid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">get_bodynames_from_position</span><span class="p">(</span><span class="n">min_point</span><span class="p">)</span>
        <span class="n">refid</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">sheet</span><span class="p">)</span>
        <span class="n">diels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_all_dielectrics_names</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">refid</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">diels</span><span class="p">:</span>
                <span class="n">refid</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">el</span><span class="p">)</span>

        <span class="n">int_start</span><span class="o">=</span><span class="kc">None</span>
        <span class="n">int_stop</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">min_point</span> <span class="o">!=</span> <span class="n">max_point</span><span class="p">:</span>
            <span class="n">int_start</span> <span class="o">=</span> <span class="n">min_point</span>
            <span class="n">int_stop</span> <span class="o">=</span> <span class="n">max_point</span>
        <span class="k">return</span> <span class="n">refid</span><span class="p">,</span> <span class="n">int_start</span><span class="p">,</span> <span class="n">int_stop</span>

<div class="viewcode-block" id="Hfss.create_wave_port_from_sheets"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.create_wave_port_from_sheets">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">create_wave_port_from_sheets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheet</span><span class="p">,</span> <span class="n">deemb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">axisdir</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">impedance</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">nummodes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">portname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                     <span class="n">renorm</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;create WavePort on sheet objects created starting from sheets</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sheet :</span>
<span class="sd">            list of input sheets from where ports will be created</span>
<span class="sd">        deemb :</span>
<span class="sd">            deembedding value distance. Float in model_units (Default value = 0)</span>
<span class="sd">        axisdir :</span>
<span class="sd">            Position of reference object. it should be one of Application.AxisDir [XNeg, YNeg, ZNeg, XPos,YPos,ZPos] (Default value = 0)</span>
<span class="sd">        impedance :</span>
<span class="sd">            Port Impedance (Default value = 50)</span>
<span class="sd">        nummodes :</span>
<span class="sd">            Number of Modes (Default value = 1)</span>
<span class="sd">        portname :</span>
<span class="sd">            Port Name. (Default value = None)</span>
<span class="sd">        renorm :</span>
<span class="sd">            Boolean, Renormalize Mode (Default value = True)</span>
<span class="sd">        deembed_dist :</span>
<span class="sd">            Deembed Distance. Float in model units (default mm). if 0 Deembed is disabled</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">            list of objects created</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sheet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">convert_to_selections</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">portnames</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">sheet</span><span class="p">:</span>
            <span class="n">refid</span><span class="p">,</span> <span class="n">int_start</span><span class="p">,</span> <span class="n">int_stop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_reference_and_integration_points</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">axisdir</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">portname</span><span class="p">:</span>
                <span class="n">portname</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Port&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">portname</span><span class="o">+</span><span class="s2">&quot;:1&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">get_excitations_name</span><span class="p">():</span>
                <span class="n">portname</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="n">portname</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="o">==</span> <span class="s2">&quot;DrivenModal&quot;</span><span class="p">:</span>
                <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_waveport_driven</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">int_start</span><span class="p">,</span> <span class="n">int_stop</span><span class="p">,</span> <span class="n">impedance</span><span class="p">,</span> <span class="n">portname</span><span class="p">,</span> <span class="n">renorm</span><span class="p">,</span> <span class="n">nummodes</span><span class="p">,</span> <span class="n">deemb</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">b</span><span class="p">:</span>
                    <span class="n">portnames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">faces</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">get_object_faces</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">refid</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_port_terminal</span><span class="p">(</span><span class="n">faces</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">refid</span><span class="p">,</span> <span class="n">portname</span><span class="p">,</span> <span class="n">iswaveport</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">b</span><span class="p">:</span>
                        <span class="n">portnames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">portnames</span></div>

<div class="viewcode-block" id="Hfss.assign_lumped_port_to_sheet"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.assign_lumped_port_to_sheet">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">assign_lumped_port_to_sheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheet_name</span><span class="p">,</span> <span class="n">axisdir</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">impedance</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">portname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                    <span class="n">renorm</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">deemb</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">reference_object_list</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot;Function that Creates a Lumped taking one sheet</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sheet_name :</span>
<span class="sd">            Sheet Name object</span>
<span class="sd">        axisdir :</span>
<span class="sd">            Integration Line direction of port. it should be one of Application.AxisDir [XNeg, YNeg, ZNeg, XPos,YPos,ZPos] (Default value = 0)</span>
<span class="sd">        impedance :</span>
<span class="sd">            Port Impedance (Default value = 50)</span>
<span class="sd">        portname :</span>
<span class="sd">            Port Name. (Default value = None)</span>
<span class="sd">        renorm :</span>
<span class="sd">            bool) Renormalize Mode (Default value = True)</span>
<span class="sd">        deemb :</span>
<span class="sd">            bool) Deembed Port (Default value = False)</span>
<span class="sd">        reference_object_list :</span>
<span class="sd">            for Driven Terminal Solutions only. list of reference conductors (Default value = [])</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        type</span>
<span class="sd">            Object Name</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;DrivenModal&quot;</span><span class="p">,</span> <span class="s2">&quot;DrivenTerminal&quot;</span><span class="p">,</span> <span class="s2">&quot;Transient Network&quot;</span><span class="p">]:</span>
            <span class="n">point0</span><span class="p">,</span> <span class="n">point1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">get_mid_points_on_dir</span><span class="p">(</span><span class="n">sheet_name</span><span class="p">,</span> <span class="n">axisdir</span><span class="p">)</span>

            <span class="n">cond</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_all_conductors_names</span><span class="p">()</span>
            <span class="n">touching</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">get_bodynames_from_position</span><span class="p">(</span><span class="n">point0</span><span class="p">)</span>
            <span class="n">listcond</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">touching</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">cond</span><span class="p">:</span>
                    <span class="n">listcond</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">el</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">portname</span><span class="p">:</span>
                <span class="n">portname</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Port&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">portname</span> <span class="o">+</span> <span class="s2">&quot;:1&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">get_excitations_name</span><span class="p">():</span>
                <span class="n">portname</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="n">portname</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="o">==</span> <span class="s2">&quot;DrivenModal&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_create_lumped_driven</span><span class="p">(</span><span class="n">sheet_name</span><span class="p">,</span> <span class="n">point0</span><span class="p">,</span> <span class="n">point1</span><span class="p">,</span> <span class="n">impedance</span><span class="p">,</span> <span class="n">portname</span><span class="p">,</span> <span class="n">renorm</span><span class="p">,</span> <span class="n">deemb</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">reference_object_list</span><span class="p">:</span>
                    <span class="n">cond</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_all_conductors_names</span><span class="p">()</span>
                    <span class="n">touching</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">get_bodynames_from_position</span><span class="p">(</span><span class="n">point0</span><span class="p">)</span>
                    <span class="n">reference_object_list</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">touching</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">cond</span><span class="p">:</span>
                            <span class="n">reference_object_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">el</span><span class="p">)</span>
                <span class="n">faces</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">get_object_faces</span><span class="p">(</span><span class="n">sheet_name</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_create_port_terminal</span><span class="p">(</span><span class="n">faces</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">reference_object_list</span><span class="p">,</span> <span class="n">portname</span><span class="p">,</span> <span class="n">iswaveport</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">portname</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Hfss.assig_voltage_source_to_sheet"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.assig_voltage_source_to_sheet">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">assig_voltage_source_to_sheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheet_name</span><span class="p">,</span> <span class="n">axisdir</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sourcename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function that Creates a Voltage Source taking one sheet.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sheet_name :</span>
<span class="sd">            Sheet name on which apply the boundary</span>
<span class="sd">        axisdir :</span>
<span class="sd">            Position of VS. it should be one of Application.AxisDir [XNeg, YNeg, ZNeg, XPos,YPos,ZPos] (Default value = 0)</span>
<span class="sd">        sourcename :</span>
<span class="sd">            Optional Source Name (Default value = None)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        type</span>
<span class="sd">            Object Name</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;DrivenModal&quot;</span><span class="p">,</span> <span class="s2">&quot;DrivenTerminal&quot;</span><span class="p">,</span> <span class="s2">&quot;Transient Network&quot;</span><span class="p">]:</span>
            <span class="n">point0</span><span class="p">,</span> <span class="n">point1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">get_mid_points_on_dir</span><span class="p">(</span><span class="n">sheet_name</span><span class="p">,</span> <span class="n">axisdir</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">sourcename</span><span class="p">:</span>
                <span class="n">sourcename</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Voltage&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">sourcename</span><span class="o">+</span><span class="s2">&quot;:1&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">get_excitations_name</span><span class="p">():</span>
                <span class="n">sourcename</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="n">sourcename</span><span class="p">)</span>
            <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_source_excitation</span><span class="p">(</span><span class="n">sheet_name</span><span class="p">,</span> <span class="n">point0</span><span class="p">,</span> <span class="n">point1</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">,</span> <span class="n">sourcetype</span><span class="o">=</span><span class="s2">&quot;Voltage&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">status</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">sourcename</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Hfss.assign_current_source_to_sheet"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.assign_current_source_to_sheet">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">assign_current_source_to_sheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheet_name</span><span class="p">,</span>  <span class="n">axisdir</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sourcename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function that Creates a Voltage Source taking one sheet.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sheet_name :</span>
<span class="sd">            Sheet name on which apply the boundary</span>
<span class="sd">        axisdir :</span>
<span class="sd">            Position of VS. it should be one of Application.AxisDir [XNeg, YNeg, ZNeg, XPos,YPos,ZPos] (Default value = 0)</span>
<span class="sd">        sourcename :</span>
<span class="sd">            Optional Source Name (Default value = None)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        type</span>
<span class="sd">            Object Name</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;DrivenModal&quot;</span><span class="p">,</span> <span class="s2">&quot;DrivenTerminal&quot;</span><span class="p">,</span> <span class="s2">&quot;Transient Network&quot;</span><span class="p">]:</span>
            <span class="n">point0</span><span class="p">,</span> <span class="n">point1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">get_mid_points_on_dir</span><span class="p">(</span><span class="n">sheet_name</span><span class="p">,</span> <span class="n">axisdir</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">sourcename</span><span class="p">:</span>
                <span class="n">sourcename</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Current&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">sourcename</span><span class="o">+</span><span class="s2">&quot;:1&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">get_excitations_name</span><span class="p">():</span>
                <span class="n">sourcename</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="n">sourcename</span><span class="p">)</span>
            <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_source_excitation</span><span class="p">(</span><span class="n">sheet_name</span><span class="p">,</span> <span class="n">point0</span><span class="p">,</span> <span class="n">point1</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">,</span> <span class="n">sourcetype</span><span class="o">=</span><span class="s2">&quot;Current&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">status</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">sourcename</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Hfss.assign_perfecte_to_sheets"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.assign_perfecte_to_sheets">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">assign_perfecte_to_sheets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheet_list</span><span class="p">,</span> <span class="n">sourcename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_infinite_gnd</span><span class="o">=</span><span class="kc">False</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function that Creates a Perfect E  taking one sheet.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sheet_list :</span>
<span class="sd">            Sheet name or list on which apply the boundary</span>
<span class="sd">        sourcename :</span>
<span class="sd">            Perfect E Name. (Default value = None)</span>
<span class="sd">        is_infinite_gnd :</span>
<span class="sd">            Boolean to determine if Perfect E is an Infinite Ground (Default value = False)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        type</span>
<span class="sd">            Boundary Object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;DrivenModal&quot;</span><span class="p">,</span> <span class="s2">&quot;DrivenTerminal&quot;</span><span class="p">,</span> <span class="s2">&quot;Transient Network&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">sourcename</span><span class="p">:</span>
                <span class="n">sourcename</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;PerfE&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">sourcename</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">get_boundaries_name</span><span class="p">():</span>
                <span class="n">sourcename</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="n">sourcename</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_boundary</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BoundaryType</span><span class="o">.</span><span class="n">PerfectE</span><span class="p">,</span> <span class="n">sheet_list</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">,</span> <span class="n">is_infinite_gnd</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="Hfss.assign_perfecth_to_sheets"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.assign_perfecth_to_sheets">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">assign_perfecth_to_sheets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheet_list</span><span class="p">,</span> <span class="n">sourcename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function that Creates a Perfect H  taking one sheet.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sheet_list :</span>
<span class="sd">            list of sheets on which apply the boundary</span>
<span class="sd">        sourcename :</span>
<span class="sd">            Perfect H Name. (Default value = None)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        type</span>
<span class="sd">            Boundary Object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;DrivenModal&quot;</span><span class="p">,</span> <span class="s2">&quot;DrivenTerminal&quot;</span><span class="p">,</span> <span class="s2">&quot;Transient Network&quot;</span><span class="p">]:</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">sourcename</span><span class="p">:</span>
                <span class="n">sourcename</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;PerfH&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">sourcename</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">get_boundaries_name</span><span class="p">():</span>
                <span class="n">sourcename</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="n">sourcename</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_boundary</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BoundaryType</span><span class="o">.</span><span class="n">PerfectH</span><span class="p">,</span> <span class="n">sheet_list</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="Hfss.assign_lumped_rlc_to_sheet"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.assign_lumped_rlc_to_sheet">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">assign_lumped_rlc_to_sheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheet_name</span><span class="p">,</span> <span class="n">axisdir</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sourcename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rlctype</span><span class="o">=</span><span class="s2">&quot;Parallel&quot;</span><span class="p">,</span>
                                          <span class="n">Rvalue</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Lvalue</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Cvalue</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function that Creates a Perfect H  taking one sheet.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sheet_name :</span>
<span class="sd">            Name of the sheet on which apply the boundary</span>
<span class="sd">        axisdir :</span>
<span class="sd">            Position of port. it should be one of Application.AxisDir [XNeg, YNeg, ZNeg, XPos,YPos,ZPos] (Default value = 0)</span>
<span class="sd">        sourcename :</span>
<span class="sd">            Perfect H Name. (Default value = None)</span>
<span class="sd">        Cvalue :</span>
<span class="sd">            Capacitance Value in F. None to disable (Default value = None)</span>
<span class="sd">        Lvalue :</span>
<span class="sd">            Inductacnce Value in H. None to disable (Default value = None)</span>
<span class="sd">        rlctype :</span>
<span class="sd">            Parallel&quot; or &quot;Series&quot; (Default value = &quot;Parallel&quot;)</span>
<span class="sd">        Rvalue :</span>
<span class="sd">            Resistance Value in Ohm. None to disable (Default value = None)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        type</span>
<span class="sd">            Object Name</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;DrivenModal&quot;</span><span class="p">,</span> <span class="s2">&quot;DrivenTerminal&quot;</span><span class="p">,</span> <span class="s2">&quot;Transient Network&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span><span class="n">Rvalue</span> <span class="ow">or</span> <span class="n">Lvalue</span> <span class="ow">or</span> <span class="n">Cvalue</span><span class="p">):</span>
            <span class="n">point0</span><span class="p">,</span> <span class="n">point1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">get_mid_points_on_dir</span><span class="p">(</span><span class="n">sheet_name</span><span class="p">,</span> <span class="n">axisdir</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">sourcename</span><span class="p">:</span>
                <span class="n">sourcename</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Lump&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">sourcename</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">get_boundaries_name</span><span class="p">():</span>
                <span class="n">sourcename</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="n">sourcename</span><span class="p">)</span>
            <span class="n">start</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">model_units</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">point0</span><span class="p">]</span>
            <span class="n">stop</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">model_units</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">point1</span><span class="p">]</span>
            <span class="n">props</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="n">props</span><span class="p">[</span><span class="s2">&quot;Objects&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">sheet_name</span><span class="p">]</span>
            <span class="n">props</span><span class="p">[</span><span class="s2">&quot;CurrentLine&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">({</span><span class="s2">&quot;Start&quot;</span><span class="p">:</span><span class="n">start</span><span class="p">,</span> <span class="s2">&quot;End&quot;</span><span class="p">:</span> <span class="n">stop</span><span class="p">})</span>
            <span class="n">props</span><span class="p">[</span><span class="s2">&quot;RLC Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">rlctype</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">Rvalue</span><span class="p">:</span>
                <span class="n">props</span><span class="p">[</span><span class="s2">&quot;UseResist&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">props</span><span class="p">[</span><span class="s2">&quot;Resistance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Rvalue</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;ohm&quot;</span>
            <span class="k">if</span> <span class="n">Lvalue</span><span class="p">:</span>
                <span class="n">props</span><span class="p">[</span><span class="s2">&quot;UseInduct&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">props</span><span class="p">[</span><span class="s2">&quot;Inductance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Lvalue</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;H&quot;</span>
            <span class="k">if</span> <span class="n">Cvalue</span><span class="p">:</span>
                <span class="n">props</span><span class="p">[</span><span class="s2">&quot;UseCap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">props</span><span class="p">[</span><span class="s2">&quot;Capacitance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Cvalue</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;F&quot;</span>
            <span class="n">bound</span> <span class="o">=</span> <span class="n">BoundaryObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">,</span> <span class="n">props</span><span class="p">,</span> <span class="s2">&quot;LumpedRLC&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">bound</span><span class="o">.</span><span class="n">create</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bound</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">bound</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Hfss.assign_impedance_to_sheet"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.assign_impedance_to_sheet">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">assign_impedance_to_sheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheet_name</span><span class="p">,</span> <span class="n">sourcename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">resistance</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">reactance</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">is_infground</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function that Creates an impedance taking one sheet.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sheet_name :</span>
<span class="sd">            Name of the sheet on which apply the boundary</span>
<span class="sd">        sourcename :</span>
<span class="sd">            impedance Name. (Default value = None)</span>
<span class="sd">        resistance :</span>
<span class="sd">            Resistance Value in Ohm. None to disable (Default value = 50)</span>
<span class="sd">        reactance :</span>
<span class="sd">            Reactance Value in Ohm. None to disable (Default value = 0)</span>
<span class="sd">        is_infground :</span>
<span class="sd">             (Default value = False)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        type</span>
<span class="sd">            Object Name</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;DrivenModal&quot;</span><span class="p">,</span> <span class="s2">&quot;DrivenTerminal&quot;</span><span class="p">,</span> <span class="s2">&quot;Transient Network&quot;</span><span class="p">]</span> <span class="p">:</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">sourcename</span><span class="p">:</span>
                <span class="n">sourcename</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Imped&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">sourcename</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">get_boundaries_name</span><span class="p">():</span>
                <span class="n">sourcename</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="n">sourcename</span><span class="p">)</span>
            <span class="n">props</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">({</span><span class="s2">&quot;Objects&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">sheet_name</span><span class="p">],</span> <span class="s2">&quot;Resistance&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">resistance</span><span class="p">),</span> <span class="s2">&quot;Reactance&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">reactance</span><span class="p">),</span>
                                 <span class="s2">&quot;InfGroundPlane&quot;</span><span class="p">:</span> <span class="n">is_infground</span><span class="p">})</span>
            <span class="n">bound</span> <span class="o">=</span> <span class="n">BoundaryObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">,</span> <span class="n">props</span><span class="p">,</span> <span class="s2">&quot;Impedance&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">bound</span><span class="o">.</span><span class="n">create</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bound</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">bound</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Hfss.create_circuit_port_from_edges"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.create_circuit_port_from_edges">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">create_circuit_port_from_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edge_signal</span><span class="p">,</span> <span class="n">edge_gnd</span><span class="p">,</span> <span class="n">port_name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                                       <span class="n">port_impedance</span><span class="o">=</span><span class="s2">&quot;50&quot;</span><span class="p">,</span>
                                       <span class="n">renormalize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">renorm_impedance</span><span class="o">=</span><span class="s2">&quot;50&quot;</span><span class="p">,</span>
                                       <span class="n">deembed</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create circuit port. Integration line from edge2 to edge1</span>
<span class="sd">        </span>
<span class="sd">        renormalize impedance is ignored in driven terminal</span>
<span class="sd">        impedance format: - int, float, str:&quot;50&quot;, str: &quot;50+1i*55&quot;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        edge_signal :</span>
<span class="sd">            edge id</span>
<span class="sd">        edge_gnd :</span>
<span class="sd">            edge id</span>
<span class="sd">        port_name :</span>
<span class="sd">            name of the port (Default value = &quot;&quot;)</span>
<span class="sd">        port_impedance :</span>
<span class="sd">            str impedance (Default value = &quot;50&quot;)</span>
<span class="sd">        renormalize :</span>
<span class="sd">            bool (Default value = False)</span>
<span class="sd">        renorm_impedance :</span>
<span class="sd">            str impedance (Default value = &quot;50&quot;)</span>
<span class="sd">        deembed :</span>
<span class="sd">            bool (Default value = False)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        type</span>
<span class="sd">            bool</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">edge_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">edge_signal</span><span class="p">,</span> <span class="n">edge_gnd</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">port_name</span><span class="p">:</span>
            <span class="n">port_name</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Port&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">port_name</span> <span class="o">+</span> <span class="s2">&quot;:1&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">get_excitations_name</span><span class="p">():</span>
            <span class="n">port_name</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="n">port_name</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_circuit_port</span><span class="p">(</span><span class="n">edge_list</span><span class="p">,</span> <span class="n">port_impedance</span><span class="p">,</span> <span class="n">port_name</span><span class="p">,</span> <span class="n">renormalize</span><span class="p">,</span>
                                           <span class="n">deembed</span><span class="p">,</span> <span class="n">renorm_impedance</span><span class="o">=</span><span class="n">renorm_impedance</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">port_name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Hfss.edit_source"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.edit_source">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">edit_source</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">portandmode</span><span class="p">,</span> <span class="n">powerin</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="s2">&quot;0deg&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Setup the Power Loaded to the Filter. this is needed for thermal Analysis</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        powerin :</span>
<span class="sd">            Power (in Watt) or project variable to be put as stored energy into the the project</span>
<span class="sd">        portandmode :</span>
<span class="sd">            Portname and mode. Example Port1:1</span>
<span class="sd">        phase :</span>
<span class="sd">             (Default value = &quot;0deg&quot;)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_messenger</span><span class="o">.</span><span class="n">add_info_message</span><span class="p">(</span><span class="s2">&quot;Setting Up Power to Eigemode &quot;</span> <span class="o">+</span> <span class="n">powerin</span> <span class="o">+</span> <span class="s2">&quot;Watt&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="o">!=</span> <span class="s2">&quot;Eigenmode&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">osolution</span><span class="o">.</span><span class="n">EditSources</span><span class="p">([[</span><span class="s2">&quot;IncludePortPostProcessing:=&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;SpecifySystemPower:=&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
                                        <span class="p">[</span><span class="s2">&quot;Name:=&quot;</span><span class="p">,</span> <span class="n">portandmode</span><span class="p">,</span> <span class="s2">&quot;Magnitude:=&quot;</span><span class="p">,</span> <span class="n">powerin</span><span class="p">,</span> <span class="s2">&quot;Phase:=&quot;</span><span class="p">,</span> <span class="n">phase</span><span class="p">]])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">osolution</span><span class="o">.</span><span class="n">EditSources</span><span class="p">(</span>
                <span class="p">[[</span><span class="s2">&quot;FieldType:=&quot;</span><span class="p">,</span> <span class="s2">&quot;EigenStoredEnergy&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;Name:=&quot;</span><span class="p">,</span> <span class="s2">&quot;Modes&quot;</span><span class="p">,</span> <span class="s2">&quot;Magnitudes:=&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">powerin</span><span class="p">]]])</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Hfss.thicken_port_sheets"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.thicken_port_sheets">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">thicken_port_sheets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputlist</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">internalExtr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">internalvalue</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;thicken_port_sheets: create thicken sheets of value &quot;mm&quot; over the full list of input port faces inputlist</span>
<span class="sd">        inputlist: list of faces to thicken</span>
<span class="sd">        value: value in mm to thicken</span>
<span class="sd">        internalExtr: define if the sheet must also be extruded internally</span>
<span class="sd">        internalvalue: define the value in mm to thicken internally the sheet (vgoing into the model)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        inputlist :</span>
<span class="sd">            </span>
<span class="sd">        value :</span>
<span class="sd">            </span>
<span class="sd">        internalExtr :</span>
<span class="sd">             (Default value = True)</span>
<span class="sd">        internalvalue :</span>
<span class="sd">             (Default value = 1)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-6</span>
        <span class="n">ports_ID</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">aedt_bounding_box</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">get_model_bounding_box</span><span class="p">()</span>
        <span class="n">directions</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">inputlist</span><span class="p">:</span>
            <span class="n">objID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">oeditor</span><span class="o">.</span><span class="n">GetFaceIDs</span><span class="p">(</span><span class="n">el</span><span class="p">)</span>
            <span class="n">faceCenter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">oeditor</span><span class="o">.</span><span class="n">GetFaceCenter</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">objID</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="n">directionfound</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">l</span> <span class="o">=</span> <span class="mi">10</span>
            <span class="k">while</span> <span class="ow">not</span> <span class="n">directionfound</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">oeditor</span><span class="o">.</span><span class="n">ThickenSheet</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="s2">&quot;NAME:Selections&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Selections:=&quot;</span><span class="p">,</span> <span class="n">el</span><span class="p">,</span>
                        <span class="s2">&quot;NewPartsModelFlag:=&quot;</span><span class="p">,</span> <span class="s2">&quot;Model&quot;</span>
                    <span class="p">],</span>
                    <span class="p">[</span>
                        <span class="s2">&quot;NAME:SheetThickenParameters&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Thickness:=&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;mm&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;BothSides:=&quot;</span><span class="p">,</span> <span class="kc">False</span>
                    <span class="p">])</span>
                <span class="c1"># aedt_bounding_box2 = self._oeditor.GetModelBoundingBox()</span>
                <span class="n">aedt_bounding_box2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">get_model_bounding_box</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_odesign</span><span class="o">.</span><span class="n">Undo</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">aedt_bounding_box</span> <span class="o">!=</span> <span class="n">aedt_bounding_box2</span><span class="p">:</span>
                    <span class="n">directions</span><span class="p">[</span><span class="n">el</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;External&quot;</span>
                    <span class="n">directionfound</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">oeditor</span><span class="o">.</span><span class="n">ThickenSheet</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="s2">&quot;NAME:Selections&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Selections:=&quot;</span><span class="p">,</span> <span class="n">el</span><span class="p">,</span>
                        <span class="s2">&quot;NewPartsModelFlag:=&quot;</span><span class="p">,</span> <span class="s2">&quot;Model&quot;</span>
                    <span class="p">],</span>
                    <span class="p">[</span>
                        <span class="s2">&quot;NAME:SheetThickenParameters&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Thickness:=&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;mm&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;BothSides:=&quot;</span><span class="p">,</span> <span class="kc">False</span>
                    <span class="p">])</span>
                <span class="c1"># aedt_bounding_box2 = self._oeditor.GetModelBoundingBox()</span>
                <span class="n">aedt_bounding_box2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">get_model_bounding_box</span><span class="p">()</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_odesign</span><span class="o">.</span><span class="n">Undo</span><span class="p">()</span>

                <span class="k">if</span> <span class="n">aedt_bounding_box</span> <span class="o">!=</span> <span class="n">aedt_bounding_box2</span><span class="p">:</span>
                    <span class="n">directions</span><span class="p">[</span><span class="n">el</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Internal&quot;</span>
                    <span class="n">directionfound</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">l</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">10</span>
        <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">inputlist</span><span class="p">:</span>
            <span class="n">objID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">oeditor</span><span class="o">.</span><span class="n">GetFaceIDs</span><span class="p">(</span><span class="n">el</span><span class="p">)</span>
            <span class="n">maxarea</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">objID</span><span class="p">:</span>
                <span class="n">faceArea</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">get_face_area</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">faceArea</span> <span class="o">&gt;</span> <span class="n">maxarea</span><span class="p">:</span>
                    <span class="n">maxarea</span> <span class="o">=</span> <span class="n">faceArea</span>
                    <span class="n">faceCenter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">oeditor</span><span class="o">.</span><span class="n">GetFaceCenter</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">directions</span><span class="p">[</span><span class="n">el</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Internal&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">oeditor</span><span class="o">.</span><span class="n">ThickenSheet</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="s2">&quot;NAME:Selections&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Selections:=&quot;</span><span class="p">,</span> <span class="n">el</span><span class="p">,</span>
                        <span class="s2">&quot;NewPartsModelFlag:=&quot;</span><span class="p">,</span> <span class="s2">&quot;Model&quot;</span>
                    <span class="p">],</span>
                    <span class="p">[</span>
                        <span class="s2">&quot;NAME:SheetThickenParameters&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Thickness:=&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;mm&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;BothSides:=&quot;</span><span class="p">,</span> <span class="kc">False</span>
                    <span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">oeditor</span><span class="o">.</span><span class="n">ThickenSheet</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="s2">&quot;NAME:Selections&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Selections:=&quot;</span><span class="p">,</span> <span class="n">el</span><span class="p">,</span>
                        <span class="s2">&quot;NewPartsModelFlag:=&quot;</span><span class="p">,</span> <span class="s2">&quot;Model&quot;</span>
                    <span class="p">],</span>
                    <span class="p">[</span>
                        <span class="s2">&quot;NAME:SheetThickenParameters&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Thickness:=&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;mm&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;BothSides:=&quot;</span><span class="p">,</span> <span class="kc">False</span>
                    <span class="p">])</span>
            <span class="k">if</span> <span class="s2">&quot;Vacuum&quot;</span> <span class="ow">in</span> <span class="n">el</span><span class="p">:</span>
                <span class="n">newfaces</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">oeditor</span><span class="o">.</span><span class="n">GetFaceIDs</span><span class="p">(</span><span class="n">el</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">newfaces</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">fc2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">oeditor</span><span class="o">.</span><span class="n">GetFaceCenter</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                        <span class="n">fc2</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">fc2</span><span class="p">]</span>
                        <span class="n">fa2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">get_face_area</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
                        <span class="n">faceoriginal</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">faceCenter</span><span class="p">]</span>
                        <span class="c1">#dist = mat.sqrt(sum([(a*a-b*b) for a,b in zip(faceCenter, fc2)]))</span>
                        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">fa2</span> <span class="o">-</span> <span class="n">maxarea</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="o">**</span><span class="mi">2</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">faceoriginal</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">fc2</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">tol</span> <span class="ow">or</span> <span class="nb">abs</span><span class="p">(</span>
                                <span class="n">faceoriginal</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">fc2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">tol</span> <span class="ow">or</span> <span class="nb">abs</span><span class="p">(</span><span class="n">faceoriginal</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">fc2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">):</span>
                            <span class="n">ports_ID</span><span class="p">[</span><span class="n">el</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

                        <span class="c1"># if (abs(faceoriginal[0] - fc2[0]) &lt; tol and abs(faceoriginal[1] - fc2[1]) &lt; tol and abs(</span>
                        <span class="c1">#         faceoriginal[2] - fc2[2]) &gt; tol) or (</span>
                        <span class="c1">#         abs(faceoriginal[0] - fc2[0]) &lt; tol and abs(faceoriginal[1] - fc2[1]) &gt; tol and abs(</span>
                        <span class="c1">#         faceoriginal[2] - fc2[2]) &lt; tol) or (</span>
                        <span class="c1">#         abs(faceoriginal[0] - fc2[0]) &gt; tol and abs(faceoriginal[1] - fc2[1]) &lt; tol and abs(</span>
                        <span class="c1">#         faceoriginal[2] - fc2[2]) &lt; tol):</span>
                        <span class="c1">#     ports_ID[el] = int(f)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">pass</span>
            <span class="k">if</span> <span class="n">internalExtr</span><span class="p">:</span>
                <span class="n">objID2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">oeditor</span><span class="o">.</span><span class="n">GetFaceIDs</span><span class="p">(</span><span class="n">el</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">fid</span> <span class="ow">in</span> <span class="n">objID2</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">faceCenter2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">oeditor</span><span class="o">.</span><span class="n">GetFaceCenter</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">fid</span><span class="p">))</span>
                        <span class="k">if</span> <span class="n">faceCenter2</span> <span class="o">==</span> <span class="n">faceCenter</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">oeditor</span><span class="o">.</span><span class="n">MoveFaces</span><span class="p">(</span>
                                <span class="p">[</span>
                                    <span class="s2">&quot;NAME:Selections&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;Selections:=&quot;</span><span class="p">,</span> <span class="n">el</span><span class="p">,</span>
                                    <span class="s2">&quot;NewPartsModelFlag:=&quot;</span><span class="p">,</span> <span class="s2">&quot;Model&quot;</span>
                                <span class="p">],</span>
                                <span class="p">[</span>
                                    <span class="s2">&quot;NAME:Parameters&quot;</span><span class="p">,</span>
                                    <span class="p">[</span>
                                        <span class="s2">&quot;NAME:MoveFacesParameters&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;MoveAlongNormalFlag:=&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span>
                                        <span class="s2">&quot;OffsetDistance:=&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">internalvalue</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;mm&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;MoveVectorX:=&quot;</span><span class="p">,</span> <span class="s2">&quot;0mm&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;MoveVectorY:=&quot;</span><span class="p">,</span> <span class="s2">&quot;0mm&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;MoveVectorZ:=&quot;</span><span class="p">,</span> <span class="s2">&quot;0mm&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;FacesToMove:=&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">fid</span><span class="p">)]</span>
                                    <span class="p">]</span>
                                <span class="p">])</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">messenger</span><span class="o">.</span><span class="n">add_debug_message</span><span class="p">(</span><span class="s2">&quot;done&quot;</span><span class="p">)</span>
                        <span class="c1"># self.modeler_oproject.ClearMessages()</span>
        <span class="k">return</span> <span class="n">ports_ID</span></div>

<div class="viewcode-block" id="Hfss.validate_full_design"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.validate_full_design">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">validate_full_design</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">outputdir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ports</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Validate the design based on expected value and save infos on log file</span>
<span class="sd">        and also returns the validation info in a list</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dname :</span>
<span class="sd">            optional, name of design to validate (Default value = None)</span>
<span class="sd">        outputdir :</span>
<span class="sd">            optional, output dir where to save the log file (Default value = None)</span>
<span class="sd">        ports :</span>
<span class="sd">            number of excitations (sum of modes) expected (Default value = None)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        type</span>
<span class="sd">            all the info in a list for use later</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_messenger</span><span class="o">.</span><span class="n">add_debug_message</span><span class="p">(</span><span class="s2">&quot;Design Validation Checks&quot;</span><span class="p">)</span>
        <span class="n">validation_ok</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">val_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">dname</span><span class="p">:</span>
            <span class="n">dname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">design_name</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">outputdir</span><span class="p">:</span>
            <span class="n">outputdir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_path</span>
        <span class="n">pname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_name</span>
        <span class="n">validation_log_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outputdir</span><span class="p">,</span> <span class="n">pname</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">dname</span> <span class="o">+</span> <span class="s2">&quot;_validation.log&quot;</span><span class="p">)</span>

        <span class="c1"># Desktop Messages</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Desktop Messages:&quot;</span>
        <span class="n">val_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="n">temp_msg</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_desktop</span><span class="o">.</span><span class="n">GetMessages</span><span class="p">(</span><span class="n">pname</span><span class="p">,</span> <span class="n">dname</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">temp_msg</span><span class="p">:</span>
            <span class="n">temp2_msg</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;Project: &#39;</span> <span class="o">+</span> <span class="n">pname</span> <span class="o">+</span> <span class="s1">&#39;, Design: &#39;</span> <span class="o">+</span> <span class="n">dname</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">temp_msg</span><span class="p">]</span>
            <span class="n">val_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">temp2_msg</span><span class="p">)</span>

        <span class="c1"># Run Design Validation and write out the lines to the logger</span>
        <span class="n">temp_val_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;TEMP&#39;</span><span class="p">],</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">val_temp.log&quot;</span><span class="p">)</span>
        <span class="n">simple_val_return</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_simple</span><span class="p">(</span><span class="n">temp_val_file</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">simple_val_return</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Design validation check PASSED!&quot;</span>
        <span class="k">elif</span> <span class="n">simple_val_return</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Design validation check ERROR!&quot;</span>
            <span class="n">validation_ok</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">val_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Design Validation Messages:&quot;</span>
        <span class="n">val_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">temp_val_file</span><span class="p">):</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">temp_val_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">df</span><span class="p">:</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
                <span class="n">val_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">temp_val_file</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;** No Design Validation File found **&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_messenger</span><span class="o">.</span><span class="n">add_debug_message</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="n">val_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;-- End of Design Validation Messages&quot;</span>
        <span class="n">val_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="c1"># Find the Excitations and check or list them out</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Excitations Check:&quot;</span>
        <span class="n">val_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="o">!=</span> <span class="s1">&#39;Eigenmode&#39;</span><span class="p">:</span>
            <span class="n">detected_excitations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">get_excitations_name</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">ports</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="o">==</span> <span class="s1">&#39;DrivenTerminal&#39;</span><span class="p">:</span>
                    <span class="n">ports_t</span> <span class="o">=</span> <span class="n">ports</span> <span class="o">*</span> <span class="mi">2</span>  <span class="c1"># for each port we have terminal and reference excitation</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ports_t</span> <span class="o">=</span> <span class="n">ports</span>
                <span class="k">if</span> <span class="n">ports_t</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">detected_excitations</span><span class="p">):</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;** Port Number Error! - Please check model **&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_messenger</span><span class="o">.</span><span class="n">add_error_message</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                    <span class="n">val_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                    <span class="n">validation_ok</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">msg1</span> <span class="o">=</span> <span class="s2">&quot;Solution type: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span><span class="p">)</span>
                    <span class="n">msg2</span> <span class="o">=</span> <span class="s2">&quot;Ports Requested: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ports</span><span class="p">)</span>
                    <span class="n">msg3</span> <span class="o">=</span> <span class="s2">&quot;Defined excitations number: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">detected_excitations</span><span class="p">))</span>
                    <span class="n">msg4</span> <span class="o">=</span> <span class="s2">&quot;Defined excitations names: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">detected_excitations</span><span class="p">)</span>
                    <span class="n">val_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg1</span><span class="p">)</span>
                    <span class="n">val_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg2</span><span class="p">)</span>
                    <span class="n">val_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg3</span><span class="p">)</span>
                    <span class="n">val_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg4</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Eigen Model Detected - no excitatons defined&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_messenger</span><span class="o">.</span><span class="n">add_debug_message</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="n">val_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="c1"># Find the number of analysis setups and output the info</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Analysis Setup Messages:&quot;</span>
        <span class="n">val_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="n">setups</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">oanalysis</span><span class="o">.</span><span class="n">GetSetups</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">setups</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Detected setup and sweep: &quot;</span>
            <span class="n">val_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">setup</span> <span class="ow">in</span> <span class="n">setups</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">setup</span><span class="p">)</span>
                <span class="n">val_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="o">!=</span> <span class="s1">&#39;EigenMode&#39;</span><span class="p">:</span>
                    <span class="n">sweepsname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">oanalysis</span><span class="o">.</span><span class="n">GetSweeps</span><span class="p">(</span><span class="n">setup</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">sweepsname</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">sw</span> <span class="ow">in</span> <span class="n">sweepsname</span><span class="p">:</span>
                            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39; |__ &#39;</span> <span class="o">+</span> <span class="n">sw</span>
                            <span class="n">val_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;No setup detected!&#39;</span>
            <span class="n">val_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">validation_log_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">val_list</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">item</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">val_list</span><span class="p">,</span> <span class="n">validation_ok</span>  <span class="c1"># return all the info in a list for use later</span></div>


<div class="viewcode-block" id="Hfss.create_scattering"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.create_scattering">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">create_scattering</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">PlotName</span><span class="o">=</span><span class="s2">&quot;S Parameter Plot Nominal&quot;</span><span class="p">,</span> <span class="n">sweep_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">PortNames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">PortExcited</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">variations</span><span class="o">=</span><span class="kc">None</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create Scattering Report</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        sweeps = design eXploration variations (list of str)</span>
<span class="sd">        PortNames = (list of str)</span>
<span class="sd">        PortExcited = (str)</span>
<span class="sd">        :return:</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        PlotName :</span>
<span class="sd">             (Default value = &quot;S Parameter Plot Nominal&quot;)</span>
<span class="sd">        sweep_name :</span>
<span class="sd">             (Default value = None)</span>
<span class="sd">        PortNames :</span>
<span class="sd">             (Default value = None)</span>
<span class="sd">        PortExcited :</span>
<span class="sd">             (Default value = None)</span>
<span class="sd">        variations :</span>
<span class="sd">             (Default value = None)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># set plot name</span>
        <span class="c1"># Setup arguments list for CreateReport function</span>
        <span class="n">Families</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Freq:=&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;All&quot;</span><span class="p">]]</span>
        <span class="k">if</span> <span class="n">variations</span><span class="p">:</span>
            <span class="n">Families</span> <span class="o">+=</span> <span class="n">variations</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Families</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_nominal_variation</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">sweep_name</span><span class="p">:</span>
            <span class="n">sweep_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">existing_analysis_sweeps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">sweep_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">existing_analysis_sweeps</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">messenger</span><span class="o">.</span><span class="n">add_error_message</span><span class="p">(</span><span class="s2">&quot;Setup </span><span class="si">{}</span><span class="s2"> doesn&#39;t exist in Setup list&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sweep_name</span><span class="p">))</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">PortNames</span><span class="p">:</span>
            <span class="n">PortNames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">get_excitations_name</span><span class="p">()</span>
        <span class="n">full_matrix</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">PortExcited</span><span class="p">:</span>
            <span class="n">PortExcited</span> <span class="o">=</span> <span class="n">PortNames</span>
            <span class="n">full_matrix</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">PortNames</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">PortNames</span> <span class="o">=</span> <span class="p">[</span><span class="n">PortNames</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">PortExcited</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">PortExcited</span> <span class="o">=</span> <span class="p">[</span><span class="n">PortExcited</span><span class="p">]</span>
        <span class="n">list_y</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">PortNames</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">PortExcited</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">full_matrix</span><span class="p">:</span>
                    <span class="n">list_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;dB(S(&quot;</span> <span class="o">+</span> <span class="n">p</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="n">q</span> <span class="o">+</span> <span class="s2">&quot;))&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">PortExcited</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">PortNames</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
                    <span class="n">list_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;dB(S(&quot;</span> <span class="o">+</span> <span class="n">p</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="n">q</span> <span class="o">+</span> <span class="s2">&quot;))&quot;</span><span class="p">)</span>

        <span class="n">Trace</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;X Component:=&quot;</span><span class="p">,</span> <span class="s2">&quot;Freq&quot;</span><span class="p">,</span> <span class="s2">&quot;Y Component:=&quot;</span><span class="p">,</span> <span class="n">list_y</span><span class="p">]</span>
        <span class="n">solution_data</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="o">==</span> <span class="s2">&quot;DrivenModal&quot;</span><span class="p">:</span>
            <span class="n">solution_data</span> <span class="o">=</span> <span class="s2">&quot;Modal Solution Data&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="o">==</span> <span class="s2">&quot;DrivenTerminal&quot;</span><span class="p">:</span>
            <span class="n">solution_data</span> <span class="o">=</span> <span class="s2">&quot;Terminal Solution Data&quot;</span>
        <span class="k">if</span> <span class="n">solution_data</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="c1"># run CreateReport function</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">oreportsetup</span><span class="o">.</span><span class="n">CreateReport</span><span class="p">(</span>
                <span class="n">PlotName</span><span class="p">,</span>
                <span class="n">solution_data</span><span class="p">,</span>
                <span class="s2">&quot;Rectangular Plot&quot;</span><span class="p">,</span>
                <span class="n">sweep_name</span><span class="p">,</span>
                <span class="p">[</span><span class="s2">&quot;Domain:=&quot;</span><span class="p">,</span> <span class="s2">&quot;Sweep&quot;</span><span class="p">],</span>
                <span class="n">Families</span><span class="p">,</span>
                <span class="n">Trace</span><span class="p">,</span>
                <span class="p">[])</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span></div>

        <span class="c1"># export the image</span>

<div class="viewcode-block" id="Hfss.create_qfactor_report"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.create_qfactor_report">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">create_qfactor_report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_dir</span><span class="p">,</span> <span class="n">outputlist</span><span class="p">,</span> <span class="n">setupname</span><span class="p">,</span> <span class="n">plotname</span><span class="p">,</span> <span class="n">Xaxis</span><span class="o">=</span><span class="s2">&quot;X&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function that export CSV of eigenQ Plot</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        project_dir :</span>
<span class="sd">            Output dir</span>
<span class="sd">        outputlist :</span>
<span class="sd">            output quantity, in this case, Q-factor</span>
<span class="sd">        setupname :</span>
<span class="sd">            Name of the setup from which generate the report</span>
<span class="sd">        plotname :</span>
<span class="sd">            name of the plot</span>
<span class="sd">        Xaxis :</span>
<span class="sd">            Xasis value (default &quot;X&quot;)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">npath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">project_dir</span><span class="p">)</span>

        <span class="c1"># Setup arguments list for createReport function</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">Xaxis</span> <span class="o">+</span> <span class="s2">&quot;:=&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;All&quot;</span><span class="p">]]</span>
        <span class="n">args2</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;X Component:=&quot;</span><span class="p">,</span> <span class="n">Xaxis</span><span class="p">,</span> <span class="s2">&quot;Y Component:=&quot;</span><span class="p">,</span> <span class="n">outputlist</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">post_oreport_setup</span><span class="o">.</span><span class="n">CreateReport</span><span class="p">(</span><span class="n">plotname</span><span class="p">,</span> <span class="s2">&quot;Eigenmode Parameters&quot;</span><span class="p">,</span> <span class="s2">&quot;Rectangular Plot&quot;</span><span class="p">,</span>
                                                  <span class="n">setupname</span> <span class="o">+</span> <span class="s2">&quot; : LastAdaptive&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">args</span><span class="p">,</span> <span class="n">args2</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Hfss.export_touchstone"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.export_touchstone">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">export_touchstone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solutionname</span><span class="p">,</span> <span class="n">sweepname</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">variation</span><span class="o">=</span><span class="p">[],</span> <span class="n">variations_value</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot;Synopsis: Export Touchston file to local folder</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        solutionname = name of the solution solved</span>
<span class="sd">        sweepname = name of the sweep solved</span>
<span class="sd">        FileName = full path of output file</span>
<span class="sd">        Variations = list (list of all parameters variations e.g. [&quot;$AmbientTemp&quot;, &quot;$PowerIn&quot;] )</span>
<span class="sd">        VariationsValue = list (list of all parameters variations value) e.g. [&quot;22cel&quot;, &quot;100&quot;] )</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        solutionname :</span>
<span class="sd">            </span>
<span class="sd">        sweepname :</span>
<span class="sd">            </span>
<span class="sd">        filename :</span>
<span class="sd">             (Default value = None)</span>
<span class="sd">        variation :</span>
<span class="sd">             (Default value = [])</span>
<span class="sd">        variations_value :</span>
<span class="sd">             (Default value = [])</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># normalize the save path</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">filename</span><span class="p">:</span>
            <span class="n">appendix</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">for</span> <span class="n">v</span><span class="p">,</span> <span class="n">vv</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">variation</span><span class="p">,</span><span class="n">variations_value</span><span class="p">):</span>
                <span class="n">appendix</span> <span class="o">+=</span> <span class="s2">&quot;_&quot;</span><span class="o">+</span> <span class="n">v</span> <span class="o">+</span> <span class="n">vv</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&#39;</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="s2">&quot;.S&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">oboundary</span><span class="o">.</span><span class="n">GetNumExcitations</span><span class="p">())</span><span class="o">+</span><span class="s2">&quot;p&quot;</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_path</span><span class="p">,</span> <span class="n">solutionname</span> <span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span> <span class="n">sweepname</span> <span class="o">+</span> <span class="n">appendix</span> <span class="o">+</span> <span class="n">ext</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;//&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exporting Touchstone &quot;</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>
        <span class="n">DesignVariations</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">i</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">variation</span><span class="p">:</span>
            <span class="n">DesignVariations</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">variation</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;=</span><span class="se">\&#39;</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">variations_value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&#39;</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\&#39;</span><span class="s2"> &quot;</span>
            <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
            <span class="c1"># DesignVariations = &quot;$AmbientTemp=\&#39;22cel\&#39; $PowerIn=\&#39;100\&#39;&quot;</span>
        <span class="c1"># array containing &quot;SetupName:SolutionName&quot; pairs (note that setup and solution are separated by a colon)</span>
        <span class="n">SolutionSelectionArray</span> <span class="o">=</span> <span class="p">[</span><span class="n">solutionname</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">sweepname</span><span class="p">]</span>
        <span class="c1"># 2=tab delimited spreadsheet (.tab), 3= touchstone (.sNp), 4= CitiFile (.cit),</span>
        <span class="c1"># 7=Matlab (.m), 8=Terminal Z0 spreadsheet</span>
        <span class="n">FileFormat</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="n">OutFile</span> <span class="o">=</span> <span class="n">filename</span>  <span class="c1"># full path of output file</span>
        <span class="n">FreqsArray</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;all&quot;</span><span class="p">]</span>  <span class="c1"># array containin the frequencies to export, use [&quot;all&quot;] for all frequencies</span>
        <span class="n">DoRenorm</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># perform renormalization before export</span>
        <span class="n">RenormImped</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># Real impedance value in ohm, for renormalization</span>
        <span class="n">DataType</span> <span class="o">=</span> <span class="s2">&quot;S&quot;</span>  <span class="c1"># Type: &quot;S&quot;, &quot;Y&quot;, or &quot;Z&quot; matrix to export</span>
        <span class="n">Pass</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>  <span class="c1"># The pass to export. -1 = export all passes.</span>
        <span class="n">ComplexFormat</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># 0=Magnitude/Phase, 1=Real/Immaginary, 2=dB/Phase</span>
        <span class="n">DigitsPrecision</span> <span class="o">=</span> <span class="mi">15</span>  <span class="c1"># Touchstone number of digits precision</span>
        <span class="n">IncludeGammaImpedance</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># Include Gamma and Impedance in comments</span>
        <span class="n">NonStandardExtensions</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Support for non-standard Touchstone extensions</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">osolution</span><span class="o">.</span><span class="n">ExportNetworkData</span><span class="p">(</span><span class="n">DesignVariations</span><span class="p">,</span> <span class="n">SolutionSelectionArray</span><span class="p">,</span> <span class="n">FileFormat</span><span class="p">,</span>
                                         <span class="n">OutFile</span><span class="p">,</span> <span class="n">FreqsArray</span><span class="p">,</span> <span class="n">DoRenorm</span><span class="p">,</span> <span class="n">RenormImped</span><span class="p">,</span> <span class="n">DataType</span><span class="p">,</span> <span class="n">Pass</span><span class="p">,</span>
                                         <span class="n">ComplexFormat</span><span class="p">,</span> <span class="n">DigitsPrecision</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="n">IncludeGammaImpedance</span><span class="p">,</span>
                                         <span class="n">NonStandardExtensions</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="Hfss.set_export_touchstone"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.set_export_touchstone">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">set_export_touchstone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">activate</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Automatic export of touchstone after simulation to True</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        activate : bool</span>
<span class="sd">            Export after simulation</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        type</span>
<span class="sd">            True if operation succeeded</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">settings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">activate</span><span class="p">:</span>
            <span class="n">settings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NAME:Design Settings Data&quot;</span><span class="p">)</span>
            <span class="n">settings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Export After Simulation:=&quot;</span><span class="p">)</span>
            <span class="n">settings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">settings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Export Dir:=&quot;</span><span class="p">)</span>
            <span class="n">settings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">activate</span><span class="p">:</span>
            <span class="n">settings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NAME:Design Settings Data&quot;</span><span class="p">)</span>
            <span class="n">settings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Export After Simulation:=&quot;</span><span class="p">)</span>
            <span class="n">settings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">odesign</span><span class="o">.</span><span class="n">SetDesignSettings</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Hfss.assign_radiation_boundary_to_objects"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.assign_radiation_boundary_to_objects">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">assign_radiation_boundary_to_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_names</span><span class="p">,</span> <span class="n">boundary_name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        obj_names :</span>
<span class="sd">            </span>
<span class="sd">        boundary_name :</span>
<span class="sd">             (Default value = &quot;&quot;)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#TODO: to be tested</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assign radiation boundary to one or more objects (usually airbox object)</span>

<span class="sd">        :param obj_names: objects name or id to which the boundary condition is assigned</span>
<span class="sd">        :param boundary_name: optional, name of the boundary</span>
<span class="sd">        :return: True if correctly assigned</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">object_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">convert_to_selections</span><span class="p">(</span><span class="n">obj_names</span><span class="p">,</span> <span class="n">return_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">boundary_name</span><span class="p">:</span>
            <span class="n">rad_name</span> <span class="o">=</span> <span class="n">boundary_name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rad_name</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Rad_&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_boundary</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BoundaryType</span><span class="o">.</span><span class="n">Radiation</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span><span class="n">rad_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="Hfss.assign_radiation_boundary_to_faces"><a class="viewcode-back" href="../../API/HFSS.html#pyaedt.hfss.Hfss.assign_radiation_boundary_to_faces">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">assign_radiation_boundary_to_faces</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">faces_id</span><span class="p">,</span> <span class="n">boundary_name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Assign radiation boundary to one or more objects (usually airbox object)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        faces_id :</span>
<span class="sd">            face id to which the boundary condition is assigned</span>
<span class="sd">        boundary_name :</span>
<span class="sd">            optional, name of the boundary (Default value = &quot;&quot;)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        type</span>
<span class="sd">            True if correctly assigned</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">faces_id</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">faces_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">faces_id</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">faces_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">faces_id</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">boundary_name</span><span class="p">:</span>
            <span class="n">rad_name</span> <span class="o">=</span> <span class="n">boundary_name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rad_name</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Rad_&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_boundary</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BoundaryType</span><span class="o">.</span><span class="n">Radiation</span><span class="p">,</span> <span class="n">faces_list</span><span class="p">,</span> <span class="n">rad_name</span><span class="p">)</span></div></div>

</pre></div>

              </div>
              
              
              <div class='prev-next-bottom'>
                

              </div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright Copyright (c) 2021 ANSYS, Inc. All rights reserved..<br/>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.0.2.<br/>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>