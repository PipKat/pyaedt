
<!DOCTYPE html>

<html lang="Python">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pyaedt.hfss3dlayout &#8212; PyAEDT 0.2.0 documentation</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><style>
    .navbar-light {
        background-color: black !important;
    }
</style>

<div class="container-xl">

    <a class="navbar-brand" href="../../index.html">
    
      <img src="../../_static/pyansys-logo-black-cropped.png" class="logo" alt="logo" />
    
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon" >
        <i class="fas fa-bars" style="color:#fff; font-size:28px;"></i>
      </span>
    </button>
    
    <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item ">
            <a class="nav-link" href="../../Resources/Installation.html">Installation</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../API/API.html">API documentation</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../Resources/Code_Guidelines.html">Code Guidelines</a>
        </li>
        
        
      </ul>


      

      <ul class="navbar-nav">
        
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/pyansys/PyAEDT" target="_blank" rel="noopener">
              <span><i class="fab fa-github-square" style="font-size:24px"></i></span>
            </a>
          </li>
        
        
        
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <h1>Source code for pyaedt.hfss3dlayout</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Hfss 3d Layout Class</span>
<span class="sd">----------------------------------------------------------------</span>


<span class="sd">Description</span>
<span class="sd">==================================================</span>

<span class="sd">This class contains all HFSS 3D Layout functionalities. It inherits all objects that belong to HFSS 3D Layout, including EDB API queries.</span>


<span class="sd">Examples:</span>

<span class="sd">hfss = Hfss3dLayout()     Creates an ``Hfss3dLayout`` object and connects to an existing HFSS design or create a new HFSS design if one is not present.</span>


<span class="sd">hfss = Hfss3dLayout(projectname)     Creates an ``Hfss3dLayout`` object and links to project named projectname. If this project doesn&#39;t exist, it creates a new one project with this name.</span>


<span class="sd">hfss = Hfss3dLayout(projectname,designame)     Creates an ``Hfss3dLayout` object and links to a design named designname in a project named projectname.</span>


<span class="sd">hfss = Hfss3dLayout(&quot;myfile.aedt&quot;)     Creates an ``Hfss3dLayout object` and opens the specified project.</span>


<span class="sd">========================================================</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">.application.Analysis3DLayout</span> <span class="kn">import</span> <span class="n">FieldAnalysis3DLayout</span>
<span class="kn">from</span> <span class="nn">.desktop</span> <span class="kn">import</span> <span class="n">exception_to_desktop</span>

<span class="kn">from</span> <span class="nn">.generic.general_methods</span> <span class="kn">import</span> <span class="n">generate_unique_name</span><span class="p">,</span> <span class="n">aedt_exception_handler</span>



<div class="viewcode-block" id="SweepString"><a class="viewcode-back" href="../../API/HFSS3DLayout.html#pyaedt.hfss3dlayout.SweepString">[docs]</a><span class="k">class</span> <span class="nc">SweepString</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;generate a sweep string like for examples &quot;LIN 10GHz 20GHz 0.05GHz LINC 20GHz 30GHz 10 DEC 30GHz 40GHz 10 40GHz&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;GHz&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        :param unit:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">unit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sweep_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

<div class="viewcode-block" id="SweepString.add_sweep"><a class="viewcode-back" href="../../API/HFSS3DLayout.html#pyaedt.hfss3dlayout.SweepString.add_sweep">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">add_sweep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sweep</span><span class="p">,</span> <span class="n">line_type</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a sweep line to the string</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sweep :</span>
<span class="sd">            list of frequencies,</span>
<span class="sd">            if linear_step [start, stop, step]</span>
<span class="sd">            if linear_count [start, stop, number of steps]</span>
<span class="sd">            if log_scale [start, stop, samples]</span>
<span class="sd">            if single [f1, f2,... fn]</span>
<span class="sd">        line_type :</span>
<span class="sd">            linear_step&quot;, &quot;linear_count&quot;, &quot;log_scale&quot;, &quot;single&quot;</span>
<span class="sd">        unit :</span>
<span class="sd">            MHz&quot;, &quot;GHz&quot;,... (Default value = None)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">unit</span><span class="p">:</span>
            <span class="n">unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sweep_string</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sweep_string</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span>
        <span class="k">if</span> <span class="n">line_type</span> <span class="o">==</span> <span class="s2">&quot;linear_step&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">sweep</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;LIN &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sweep</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">unit</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sweep</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">unit</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sweep</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="n">unit</span>
        <span class="k">elif</span> <span class="n">line_type</span> <span class="o">==</span> <span class="s2">&quot;linear_count&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">sweep</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;LINC &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sweep</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">unit</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sweep</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">unit</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sweep</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">line_type</span> <span class="o">==</span> <span class="s2">&quot;log_scale&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">sweep</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;DEC &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sweep</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">unit</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sweep</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">unit</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sweep</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">line_type</span> <span class="o">==</span> <span class="s2">&quot;single&quot;</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">sweep</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">+</span> <span class="n">unit</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Wrong format for sweep list!&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sweep_string</span> <span class="o">+=</span> <span class="n">string</span></div>

<div class="viewcode-block" id="SweepString.get_string"><a class="viewcode-back" href="../../API/HFSS3DLayout.html#pyaedt.hfss3dlayout.SweepString.get_string">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">get_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sweep_string</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sweep_string</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div></div>


<div class="viewcode-block" id="Hfss3dLayout"><a class="viewcode-back" href="../../API/HFSS3DLayout.html#pyaedt.hfss3dlayout.Hfss3dLayout">[docs]</a><span class="k">class</span> <span class="nc">Hfss3dLayout</span><span class="p">(</span><span class="n">FieldAnalysis3DLayout</span><span class="p">,</span> <span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;HFSS 3D Layout Object</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    projectname :</span>
<span class="sd">        name of the project to be selected or full path to the project to be opened  or to the AEDTZ archive. if None try to get active project and, if nothing present to create an empty one</span>
<span class="sd">    designname :</span>
<span class="sd">        name of the design to be selected. if None, try to get active design and, if nothing present to create an empty one</span>
<span class="sd">    solution_type :</span>
<span class="sd">        solution type to be applied to design. if None default is taken</span>
<span class="sd">    setup_name :</span>
<span class="sd">        setup_name to be used as nominal. if none active setup is taken or nothing</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">projectname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">designname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">solution_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">setup_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">FieldAnalysis3DLayout</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;HFSS 3D Layout Design&quot;</span><span class="p">,</span> <span class="n">projectname</span><span class="p">,</span> <span class="n">designname</span><span class="p">,</span> <span class="n">solution_type</span><span class="p">,</span>
                                       <span class="n">setup_name</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ex_type</span><span class="p">,</span> <span class="n">ex_value</span><span class="p">,</span> <span class="n">ex_traceback</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Push exit up to parent object Design &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">ex_type</span><span class="p">:</span>
            <span class="n">exception_to_desktop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ex_value</span><span class="p">,</span> <span class="n">ex_traceback</span><span class="p">)</span>

<div class="viewcode-block" id="Hfss3dLayout.create_edge_port"><a class="viewcode-back" href="../../API/HFSS3DLayout.html#pyaedt.hfss3dlayout.Hfss3dLayout.create_edge_port">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">create_edge_port</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">primivitivename</span><span class="p">,</span> <span class="n">edgenumber</span><span class="p">,</span> <span class="n">iscircuit</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new edge port</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        primivitivename :</span>
<span class="sd">            name of the primitive</span>
<span class="sd">        edgenumber :</span>
<span class="sd">            edge number on which create a port</span>
<span class="sd">        iscircuit :</span>
<span class="sd">            True (Circuit Port) | False (Default value = True)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        type</span>
<span class="sd">            Name of the port</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">listp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">port_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">oeditor</span><span class="o">.</span><span class="n">CreateEdgePort</span><span class="p">(</span>
            <span class="p">[</span><span class="s2">&quot;NAME:Contents&quot;</span><span class="p">,</span> <span class="s2">&quot;edge:=&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;et:=&quot;</span><span class="p">,</span> <span class="s2">&quot;pe&quot;</span><span class="p">,</span> <span class="s2">&quot;prim:=&quot;</span><span class="p">,</span> <span class="n">primivitivename</span><span class="p">,</span> <span class="s2">&quot;edge:=&quot;</span><span class="p">,</span> <span class="n">edgenumber</span><span class="p">],</span> <span class="s2">&quot;circuit:=&quot;</span><span class="p">,</span>
             <span class="n">iscircuit</span><span class="p">,</span> <span class="s2">&quot;btype:=&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">listnew</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">port_list</span>
        <span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">listnew</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">listp</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Hfss3dLayout.create_coax_port"><a class="viewcode-back" href="../../API/HFSS3DLayout.html#pyaedt.hfss3dlayout.Hfss3dLayout.create_coax_port">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">create_coax_port</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vianame</span><span class="p">,</span> <span class="n">layer</span><span class="p">,</span> <span class="n">xstart</span><span class="p">,</span> <span class="n">xend</span><span class="p">,</span><span class="n">ystart</span><span class="p">,</span> <span class="n">yend</span><span class="p">,</span> <span class="n">archeight</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">arcrad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">isexternal</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new Coax Port</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        vianame :</span>
<span class="sd">            Name of the Via on which create a new Port</span>
<span class="sd">        layer :</span>
<span class="sd">            layer name</span>
<span class="sd">        xstart :</span>
<span class="sd">            x position of pin</span>
<span class="sd">        ystart :</span>
<span class="sd">            y position of pin</span>
<span class="sd">        xend :</span>
<span class="sd">            x end position of pin</span>
<span class="sd">        yend :</span>
<span class="sd">            y end position of pin</span>
<span class="sd">        archeight :</span>
<span class="sd">            arc height (Default value = 0)</span>
<span class="sd">        arcrad :</span>
<span class="sd">            rotation of pin in rad (Default value = 0)</span>
<span class="sd">        isexternal :</span>
<span class="sd">            True (is external pin) | False is internal Pin (Default value = True)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        type</span>
<span class="sd">            name of the port | False error</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">listp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">port_list</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">layerid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">layer_id</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">layerid</span> <span class="o">=</span> <span class="n">layer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">oeditor</span><span class="o">.</span><span class="n">CreateEdgePort</span><span class="p">([</span><span class="s2">&quot;NAME:Contents&quot;</span><span class="p">,</span> <span class="s2">&quot;edge:=&quot;</span><span class="p">,</span>
                                             <span class="p">[</span><span class="s2">&quot;et:=&quot;</span><span class="p">,</span> <span class="s2">&quot;pse&quot;</span><span class="p">,</span> <span class="s2">&quot;sel:=&quot;</span><span class="p">,</span> <span class="n">vianame</span><span class="p">,</span> <span class="s2">&quot;layer:=&quot;</span><span class="p">,</span> <span class="n">layerid</span><span class="p">,</span> <span class="s2">&quot;sx:=&quot;</span><span class="p">,</span> <span class="n">xstart</span><span class="p">,</span> <span class="s2">&quot;sy:=&quot;</span><span class="p">,</span>
                                              <span class="n">ystart</span><span class="p">,</span> <span class="s2">&quot;ex:=&quot;</span><span class="p">,</span> <span class="n">xend</span><span class="p">,</span> <span class="s2">&quot;ey:=&quot;</span><span class="p">,</span> <span class="n">yend</span><span class="p">,</span> <span class="s2">&quot;h:=&quot;</span><span class="p">,</span> <span class="n">archeight</span><span class="p">,</span> <span class="s2">&quot;rad:=&quot;</span><span class="p">,</span> <span class="n">arcrad</span><span class="p">],</span>
                                             <span class="s2">&quot;external:=&quot;</span><span class="p">,</span> <span class="n">isexternal</span><span class="p">])</span>
        <span class="n">listnew</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">port_list</span>
        <span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">listnew</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">listp</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Hfss3dLayout.create_pin_port"><a class="viewcode-back" href="../../API/HFSS3DLayout.html#pyaedt.hfss3dlayout.Hfss3dLayout.create_pin_port">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">create_pin_port</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">xpos</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ypos</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">top_layer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bot_layer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new Pin Port</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name :</span>
<span class="sd">            Name of the Pin Port</span>
<span class="sd">        xpos :</span>
<span class="sd">            x position of pin (Default value = 0)</span>
<span class="sd">        ypos :</span>
<span class="sd">            y position of pin (Default value = 0)</span>
<span class="sd">        rotation :</span>
<span class="sd">            rotation of pin in deg (Default value = 0)</span>
<span class="sd">        top_layer :</span>
<span class="sd">            top layer of pin. if None, it will be automatically assigned to the top (Default value = None)</span>
<span class="sd">        bot_layer :</span>
<span class="sd">            bottom layer of pin. if None, it will be automatically assigned to the bottom (Default value = None)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        type</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">refresh_all_layers</span><span class="p">()</span>
        <span class="n">layers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">all_signal_layers</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">top_layer</span><span class="p">:</span>
            <span class="n">top_layer</span> <span class="o">=</span> <span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">bot_layer</span><span class="p">:</span>
            <span class="n">bot_layer</span> <span class="o">=</span> <span class="n">layers</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">layers</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">oeditor</span><span class="o">.</span><span class="n">CreatePin</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="s2">&quot;NAME:Contents&quot;</span><span class="p">,</span>
                <span class="p">[</span>
                    <span class="s2">&quot;NAME:Port&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Name:=&quot;</span>	<span class="p">,</span> <span class="n">name</span>
                <span class="p">],</span>
                <span class="s2">&quot;ReferencedPadstack:=&quot;</span>	<span class="p">,</span> <span class="s2">&quot;Padstacks:NoPad SMT East&quot;</span><span class="p">,</span>
                <span class="s2">&quot;vposition:=&quot;</span><span class="p">,</span>
                <span class="p">[</span><span class="s2">&quot;x:=&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">xpos</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">model_units</span><span class="p">,</span> <span class="s2">&quot;y:=&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">ypos</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">model_units</span><span class="p">],</span>
                <span class="s2">&quot;vrotation:=&quot;</span>		<span class="p">,</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">rotation</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;deg&quot;</span><span class="p">],</span>
                <span class="s2">&quot;overrides hole:=&quot;</span>	<span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s2">&quot;hole diameter:=&quot;</span>	<span class="p">,</span> <span class="p">[</span><span class="s2">&quot;0mm&quot;</span><span class="p">],</span>
                <span class="s2">&quot;Pin:=&quot;</span>			<span class="p">,</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s2">&quot;highest_layer:=&quot;</span>	<span class="p">,</span> <span class="n">top_layer</span><span class="p">,</span>
                <span class="s2">&quot;lowest_layer:=&quot;</span>	<span class="p">,</span> <span class="n">bot_layer</span>
            <span class="p">])</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Hfss3dLayout.delete_port"><a class="viewcode-back" href="../../API/HFSS3DLayout.html#pyaedt.hfss3dlayout.Hfss3dLayout.delete_port">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">delete_port</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">portname</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        portname :</span>
<span class="sd">            </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oexcitation</span><span class="o">.</span><span class="n">Delete</span><span class="p">(</span><span class="n">portname</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Hfss3dLayout.import_edb"><a class="viewcode-back" href="../../API/HFSS3DLayout.html#pyaedt.hfss3dlayout.Hfss3dLayout.import_edb">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">import_edb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edb_full_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        edb_full_path :</span>
<span class="sd">            </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">oTool</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">odesktop</span><span class="o">.</span><span class="n">GetTool</span><span class="p">(</span><span class="s2">&quot;ImportExport&quot;</span><span class="p">)</span>
        <span class="n">oTool</span><span class="o">.</span><span class="n">ImportEDB</span><span class="p">(</span><span class="n">edb_full_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oproject</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">odesktop</span><span class="o">.</span><span class="n">GetActiveProject</span><span class="p">()</span><span class="o">.</span><span class="n">GetName</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">odesign</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">odesktop</span><span class="o">.</span><span class="n">GetActiveProject</span><span class="p">()</span><span class="o">.</span><span class="n">GetActiveDesign</span><span class="p">()</span><span class="o">.</span><span class="n">GetName</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Hfss3dLayout.validate_full_design"><a class="viewcode-back" href="../../API/HFSS3DLayout.html#pyaedt.hfss3dlayout.Hfss3dLayout.validate_full_design">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">validate_full_design</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">outputdir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ports</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Validate the design based on expected value and save infos on log file</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name :</span>
<span class="sd">            name of design to validate (Default value = None)</span>
<span class="sd">        outputdir :</span>
<span class="sd">            output dir where to save the log file (Default value = None)</span>
<span class="sd">        ports :</span>
<span class="sd">            number of excitations expected (Default value = None)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        type</span>
<span class="sd">            all the info in a list for use later</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">design_name</span>
        <span class="k">if</span> <span class="n">outputdir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">outputdir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_path</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_messenger</span><span class="o">.</span><span class="n">add_info_message</span><span class="p">(</span><span class="s2">&quot;#### Design Validation Checks###&quot;</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Routine outputs to the validtaion info to a log file in the project directory and also</span>
        <span class="c1"># returns the validation info to be used to update properties.xml file</span>

        <span class="n">validation_ok</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1">#</span>
        <span class="c1"># Write an overall validation log file with all output from all checks</span>
        <span class="c1"># the design validation inside HFSS outputs to a separate log file which we merge into this overall file</span>
        <span class="c1">#</span>
        <span class="n">val_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">all_validate</span> <span class="o">=</span> <span class="n">outputdir</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">all_validation.log&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">all_validate</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">validation</span><span class="p">:</span>

            <span class="c1"># Desktop Messages</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Desktop Messages:&quot;</span>
            <span class="n">validation</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">msg</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">val_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="n">msgs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_desktop</span><span class="o">.</span><span class="n">GetMessages</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;HFSSDesign1&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="c1"># need to check if design name is always this default name HFSSDesign1</span>
            <span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">msgs</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_messenger</span><span class="o">.</span><span class="n">add_info_message</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                <span class="c1"># msg = msg.replace(&#39;&quot;&#39;,&#39;&#39;)</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="n">msg</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">val_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                <span class="n">validation</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">msg</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1"># Run Design Validation and write out the lines to the logger</span>

            <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_odesign</span><span class="o">.</span><span class="n">ValidateCircuit</span><span class="p">()</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Design Validation Messages:&quot;</span>
            <span class="n">validation</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">msg</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">val_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ret</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;**** ERRORS Present - please check and confirm&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_messenger</span><span class="o">.</span><span class="n">add_error_message</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;**** Validation Completed Correctly&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_messenger</span><span class="o">.</span><span class="n">add_info_message</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

            <span class="c1"># Find the Excitations and check or list them out</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Excitation Messages:&quot;</span>
            <span class="n">validation</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">msg</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">val_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="n">numportsdefined</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_excitations_name</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">ports</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ports</span> <span class="o">!=</span> <span class="n">numportsdefined</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;**** Port Number Error! - Please check model&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_messenger</span><span class="o">.</span><span class="n">add_error_message</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                <span class="n">validation</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">msg</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">val_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                <span class="n">validation_ok</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="c1"># need to stop the simulation athis point</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg1</span> <span class="o">=</span> <span class="s2">&quot;Ports Requested: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ports</span><span class="p">)</span>
                <span class="n">msg2</span> <span class="o">=</span> <span class="s2">&quot;Ports Defined: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">numportsdefined</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_messenger</span><span class="o">.</span><span class="n">add_info_message</span><span class="p">(</span><span class="n">msg1</span><span class="p">)</span>
                <span class="n">validation</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">msg1</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">val_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_messenger</span><span class="o">.</span><span class="n">add_info_message</span><span class="p">(</span><span class="n">msg2</span><span class="p">)</span>
                <span class="n">validation</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">msg2</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">val_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg2</span><span class="p">)</span>

            <span class="n">excitation_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_excitations_name</span>
            <span class="k">for</span> <span class="n">excitation</span> <span class="ow">in</span> <span class="n">excitation_names</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Excitation name: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">excitation</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_messenger</span><span class="o">.</span><span class="n">add_info_message</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                <span class="n">validation</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">msg</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">val_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="n">validation</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">val_list</span><span class="p">,</span> <span class="n">validation_ok</span>  <span class="c1"># return all the info in a list for use later</span></div>

<div class="viewcode-block" id="Hfss3dLayout.create_scattering"><a class="viewcode-back" href="../../API/HFSS3DLayout.html#pyaedt.hfss3dlayout.Hfss3dLayout.create_scattering">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">create_scattering</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">PlotName</span><span class="o">=</span><span class="s2">&quot;S Parameter Plot Nominal&quot;</span><span class="p">,</span> <span class="n">sweep_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">PortNames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">PortExcited</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">variations</span><span class="o">=</span><span class="kc">None</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create Scattering Report</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        sweeps = design eXploration variations (list of str)</span>
<span class="sd">        PortNames = (list of str)</span>
<span class="sd">        PortExcited = (str)</span>
<span class="sd">        :return:</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        PlotName :</span>
<span class="sd">             (Default value = &quot;S Parameter Plot Nominal&quot;)</span>
<span class="sd">        sweep_name :</span>
<span class="sd">             (Default value = None)</span>
<span class="sd">        PortNames :</span>
<span class="sd">             (Default value = None)</span>
<span class="sd">        PortExcited :</span>
<span class="sd">             (Default value = None)</span>
<span class="sd">        variations :</span>
<span class="sd">             (Default value = None)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># set plot name</span>
        <span class="c1"># Setup arguments list for CreateReport function</span>
        <span class="n">Families</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Freq:=&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;All&quot;</span><span class="p">]]</span>
        <span class="k">if</span> <span class="n">variations</span><span class="p">:</span>
            <span class="n">Families</span> <span class="o">+=</span><span class="n">variations</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Families</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_nominal_variation</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">sweep_name</span><span class="p">:</span>
            <span class="n">sweep_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">existing_analysis_sweeps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">PortNames</span><span class="p">:</span>
            <span class="n">PortNames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">get_excitations_name</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">PortExcited</span><span class="p">:</span>
            <span class="n">PortExcited</span><span class="o">=</span> <span class="n">PortNames</span>
        <span class="n">Trace</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;X Component:=&quot;</span><span class="p">,</span> <span class="s2">&quot;Freq&quot;</span><span class="p">,</span> <span class="s2">&quot;Y Component:=&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;dB(S(&quot;</span> <span class="o">+</span> <span class="n">p</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="n">q</span> <span class="o">+</span> <span class="s2">&quot;))&quot;</span> <span class="k">for</span> <span class="n">p</span><span class="p">,</span><span class="n">q</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">PortNames</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="n">PortExcited</span><span class="p">))]]</span>
        <span class="n">solution_data</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="o">==</span> <span class="s2">&quot;DrivenModal&quot;</span><span class="p">:</span>
            <span class="n">solution_data</span> <span class="o">=</span> <span class="s2">&quot;Modal Solution Data&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="o">==</span> <span class="s2">&quot;DrivenTerminal&quot;</span><span class="p">:</span>
            <span class="n">solution_data</span> <span class="o">=</span> <span class="s2">&quot;Terminal Solution Data&quot;</span>
        <span class="k">if</span> <span class="n">solution_data</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="c1"># run CreateReport function</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">oreportsetup</span><span class="o">.</span><span class="n">CreateReport</span><span class="p">(</span>
                <span class="n">PlotName</span><span class="p">,</span>
                <span class="n">solution_data</span><span class="p">,</span>
                <span class="s2">&quot;Rectangular Plot&quot;</span><span class="p">,</span>
                <span class="n">sweep_name</span><span class="p">,</span>
                <span class="p">[</span><span class="s2">&quot;Domain:=&quot;</span><span class="p">,</span> <span class="s2">&quot;Sweep&quot;</span><span class="p">],</span>
                <span class="n">Families</span><span class="p">,</span>
                <span class="n">Trace</span><span class="p">,</span>
                <span class="p">[])</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>

        <span class="c1"># export the image</span>

<div class="viewcode-block" id="Hfss3dLayout.export_touchstone"><a class="viewcode-back" href="../../API/HFSS3DLayout.html#pyaedt.hfss3dlayout.Hfss3dLayout.export_touchstone">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">export_touchstone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solutionname</span><span class="p">,</span> <span class="n">sweepname</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">variation</span><span class="p">,</span> <span class="n">variations_value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Export the touchstone file</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        solutionname = name of the solution solved</span>
<span class="sd">        sweepname = name of the sweep solved</span>
<span class="sd">        FileName = full path of output file</span>
<span class="sd">        Variations = list (list of all parameters variations e.g. [&quot;$AmbientTemp&quot;, &quot;$PowerIn&quot;] )</span>
<span class="sd">        VariationsValue = list (list of all parameters variations value) e.g. [&quot;22cel&quot;, &quot;100&quot;] )</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        solutionname :</span>
<span class="sd">            </span>
<span class="sd">        sweepname :</span>
<span class="sd">            </span>
<span class="sd">        filename :</span>
<span class="sd">            </span>
<span class="sd">        variation :</span>
<span class="sd">            </span>
<span class="sd">        variations_value :</span>
<span class="sd">            </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># normalize the save path</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">filename</span><span class="p">:</span>
            <span class="n">appendix</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">for</span> <span class="n">v</span><span class="p">,</span> <span class="n">vv</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">variation</span><span class="p">,</span> <span class="n">variations_value</span><span class="p">):</span>
                <span class="n">appendix</span> <span class="o">+=</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">v</span> <span class="o">+</span> <span class="n">vv</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&#39;</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="s2">&quot;.S&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">port_list</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;p&quot;</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_path</span><span class="p">,</span> <span class="n">solutionname</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">sweepname</span> <span class="o">+</span> <span class="n">appendix</span> <span class="o">+</span> <span class="n">ext</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;//&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exporting Touchstone &quot;</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>
        <span class="c1"># array containing &quot;SetupName:SolutionName&quot; pairs (note that setup and solution are separated by a colon)</span>
        <span class="n">SolutionSelectionArray</span> <span class="o">=</span> <span class="p">[</span><span class="n">solutionname</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">sweepname</span><span class="p">]</span>
        <span class="c1"># 2=tab delimited spreadsheet (.tab), 3= touchstone (.sNp), 4= CitiFile (.cit),</span>
        <span class="c1"># 7=Matlab (.m), 8=Terminal Z0 spreadsheet</span>
        <span class="n">FileFormat</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="n">OutFile</span> <span class="o">=</span> <span class="n">filename</span>  <span class="c1"># full path of output file</span>
        <span class="n">FreqsArray</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;all&quot;</span><span class="p">]</span>  <span class="c1"># array containin the frequencies to export, use [&quot;all&quot;] for all frequencies</span>
        <span class="n">DoRenorm</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># perform renormalization before export</span>
        <span class="n">RenormImped</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># Real impedance value in ohm, for renormalization</span>
        <span class="n">DataType</span> <span class="o">=</span> <span class="s2">&quot;S&quot;</span>  <span class="c1"># Type: &quot;S&quot;, &quot;Y&quot;, or &quot;Z&quot; matrix to export</span>
        <span class="n">Pass</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>  <span class="c1"># The pass to export. -1 = export all passes.</span>
        <span class="n">ComplexFormat</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># 0=Magnitude/Phase, 1=Real/Immaginary, 2=dB/Phase</span>
        <span class="n">DigitsPrecision</span> <span class="o">=</span> <span class="mi">15</span>  <span class="c1"># Touchstone number of digits precision</span>
        <span class="n">IncludeGammaImpedance</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># Include Gamma and Impedance in comments</span>
        <span class="n">NonStandardExtensions</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Support for non-standard Touchstone extensions</span>
        <span class="n">variation_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">v</span><span class="p">,</span> <span class="n">vv</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">variation</span><span class="p">,</span> <span class="n">variations_value</span><span class="p">):</span>
            <span class="n">variation_str</span> <span class="o">+=</span> <span class="n">v</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">+</span> <span class="n">vv</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">odesign</span><span class="o">.</span><span class="n">ExportNetworkData</span><span class="p">(</span><span class="n">variation_str</span><span class="p">,</span> <span class="n">SolutionSelectionArray</span><span class="p">,</span> <span class="n">FileFormat</span><span class="p">,</span>
                                       <span class="n">OutFile</span><span class="p">,</span> <span class="n">FreqsArray</span><span class="p">,</span> <span class="n">DoRenorm</span><span class="p">,</span> <span class="n">RenormImped</span><span class="p">,</span> <span class="n">DataType</span><span class="p">,</span> <span class="n">Pass</span><span class="p">,</span> <span class="n">ComplexFormat</span><span class="p">,</span>
                                       <span class="n">DigitsPrecision</span><span class="p">,</span> <span class="n">IncludeGammaImpedance</span><span class="p">,</span> <span class="n">IncludeGammaImpedance</span><span class="p">,</span>
                                       <span class="n">NonStandardExtensions</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Hfss3dLayout.set_export_touchstone"><a class="viewcode-back" href="../../API/HFSS3DLayout.html#pyaedt.hfss3dlayout.Hfss3dLayout.set_export_touchstone">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">set_export_touchstone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">activate</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Automatic export of touchstone after simulation to True</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        activate : bool</span>
<span class="sd">            Export after simulation</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        type</span>
<span class="sd">            True if operation succeeded</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">settings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">activate</span><span class="p">:</span>
            <span class="n">settings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NAME:Design Settings Data&quot;</span><span class="p">)</span>
            <span class="n">settings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Export After Simulation:=&quot;</span><span class="p">)</span>
            <span class="n">settings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">settings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Export Dir:=&quot;</span><span class="p">)</span>
            <span class="n">settings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">activate</span><span class="p">:</span>
            <span class="n">settings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NAME:Design Settings Data&quot;</span><span class="p">)</span>
            <span class="n">settings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Export After Simulation:=&quot;</span><span class="p">)</span>
            <span class="n">settings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">odesign</span><span class="o">.</span><span class="n">SetDesignSettings</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Hfss3dLayout.create_frequency_sweep"><a class="viewcode-back" href="../../API/HFSS3DLayout.html#pyaedt.hfss3dlayout.Hfss3dLayout.create_frequency_sweep">[docs]</a>    <span class="nd">@aedt_exception_handler</span>
    <span class="k">def</span> <span class="nf">create_frequency_sweep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">setupname</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">freqstart</span><span class="p">,</span> <span class="n">freqstop</span><span class="p">,</span> <span class="n">num_of_freq_points</span><span class="p">,</span>
                               <span class="n">sweepname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sweeptype</span><span class="o">=</span><span class="s2">&quot;interpolating&quot;</span><span class="p">,</span>
                               <span class="n">interpolation_tol_percent</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">interpolation_max_solutions</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span>
                               <span class="n">save_fields</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save_rad_fields_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                               <span class="n">use_q3d_for_dc</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a Frequency Sweep</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        setupname :</span>
<span class="sd">            name of the setup to which is attached the sweep</span>
<span class="sd">        unit :</span>
<span class="sd">            Units (&quot;MHz&quot;, &quot;GHz&quot;....)</span>
<span class="sd">        freqstart :</span>
<span class="sd">            Starting Frequency of sweep</span>
<span class="sd">        freqstop :</span>
<span class="sd">            Stop Frequency of Sweep</span>
<span class="sd">        sweepname :</span>
<span class="sd">            name of the Sweep (Default value = None)</span>
<span class="sd">        num_of_freq_points :</span>
<span class="sd">            Number of frequency point in the range</span>
<span class="sd">        sweeptype :</span>
<span class="sd">            discrete&quot;|&quot;interpolating&quot; (default)</span>
<span class="sd">        interpolation_max_solutions :</span>
<span class="sd">            max number of solutions evaluated for the interpolation process (Default value = 250)</span>
<span class="sd">        interpolation_tol_percent :</span>
<span class="sd">            error tolerance threshold for the interpolation process (Default value = 0.5)</span>
<span class="sd">        save_fields :</span>
<span class="sd">            save the fields (only for discrete sweep) (Default value = True)</span>
<span class="sd">        save_rad_fields_only :</span>
<span class="sd">            save only the radiated fields (only if save_fields = True) (Default value = False)</span>
<span class="sd">        use_q3d_for_dc :</span>
<span class="sd">            Use Q3D to solve DC point (Default value = False)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        type</span>
<span class="sd">            Setup Name if operation succeeded</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">sweepname</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sweepname</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Sweep&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sweeptype</span> <span class="o">==</span> <span class="s2">&quot;interpolating&quot;</span><span class="p">:</span>
            <span class="n">interpolation</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">save_fields</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">sweeptype</span> <span class="o">==</span> <span class="s2">&quot;discrete&quot;</span><span class="p">:</span>
            <span class="n">interpolation</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">save_fields</span><span class="p">:</span>
            <span class="n">save_rad_fields_only</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">interpolation_tol</span> <span class="o">=</span> <span class="n">interpolation_tol_percent</span> <span class="o">/</span> <span class="mf">100.</span>
        <span class="n">sweep</span> <span class="o">=</span> <span class="n">SweepString</span><span class="p">()</span>
        <span class="n">sweep</span><span class="o">.</span><span class="n">add_sweep</span><span class="p">([</span><span class="n">freqstart</span><span class="p">,</span> <span class="n">freqstop</span><span class="p">,</span> <span class="n">num_of_freq_points</span><span class="p">],</span> <span class="s2">&quot;linear_count&quot;</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>
        <span class="c1"># the add_sweep function supports all sweeps type e.g.</span>
        <span class="c1">#   sweep.add_sweep([10, 20, 1], &quot;linear_step&quot;, &quot;MHz&quot;)</span>
        <span class="c1">#   sweep.add_sweep([1, 1000, 100], &quot;log_scale&quot;, &quot;kHz&quot;)</span>
        <span class="c1">#   sweep.add_sweep([7,13,17,19,23], &quot;single&quot;, unit)</span>
        <span class="n">sweep_string</span> <span class="o">=</span> <span class="n">sweep</span><span class="o">.</span><span class="n">get_string</span><span class="p">()</span>

        <span class="n">arg</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;NAME:&quot;</span> <span class="o">+</span> <span class="n">sweepname</span><span class="p">,</span>
               <span class="p">[</span>
                <span class="s2">&quot;NAME:Properties&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Enable:=&quot;</span><span class="p">,</span> <span class="s2">&quot;true&quot;</span>
               <span class="p">],</span>
               <span class="p">[</span>
                <span class="s2">&quot;NAME:Sweeps&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Variable:=&quot;</span><span class="p">,</span> <span class="n">sweepname</span><span class="p">,</span>
                <span class="s2">&quot;Data:=&quot;</span><span class="p">,</span> <span class="n">sweep_string</span><span class="p">,</span>
                <span class="s2">&quot;OffsetF1:=&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s2">&quot;Synchronize:=&quot;</span><span class="p">,</span> <span class="mi">0</span>
               <span class="p">],</span>
               <span class="s2">&quot;GenerateSurfaceCurrent:=&quot;</span><span class="p">,</span> <span class="n">save_fields</span><span class="p">,</span>
               <span class="s2">&quot;SaveRadFieldsOnly:=&quot;</span><span class="p">,</span> <span class="n">save_rad_fields_only</span><span class="p">,</span>
               <span class="s2">&quot;FastSweep:=&quot;</span><span class="p">,</span> <span class="n">interpolation</span><span class="p">,</span>
               <span class="s2">&quot;ZoSelected:=&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
               <span class="s2">&quot;SAbsError:=&quot;</span><span class="p">,</span> <span class="n">interpolation_tol</span><span class="p">,</span>
               <span class="s2">&quot;ZoPercentError:=&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
               <span class="s2">&quot;GenerateStateSpace:=&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
               <span class="s2">&quot;EnforcePassivity:=&quot;</span><span class="p">,</span> <span class="n">interpolation</span><span class="p">,</span>
               <span class="s2">&quot;PassivityTolerance:=&quot;</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">,</span>
               <span class="s2">&quot;UseQ3DForDC:=&quot;</span><span class="p">,</span> <span class="n">use_q3d_for_dc</span><span class="p">,</span>
               <span class="s2">&quot;ResimulateDC:=&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
               <span class="s2">&quot;MaxSolutions:=&quot;</span><span class="p">,</span> <span class="n">interpolation_max_solutions</span><span class="p">,</span>
               <span class="s2">&quot;InterpUseSMatrix:=&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span>
               <span class="s2">&quot;InterpUsePortImpedance:=&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span>
               <span class="s2">&quot;InterpUsePropConst:=&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span>
               <span class="s2">&quot;InterpUseFullBasis:=&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span>
               <span class="s2">&quot;CustomFrequencyString:=&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
               <span class="s2">&quot;AllEntries:=&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
               <span class="s2">&quot;AllDiagEntries:=&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
               <span class="s2">&quot;AllOffDiagEntries:=&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
               <span class="s2">&quot;MagMinThreshold:=&quot;</span><span class="p">,</span> <span class="mf">0.01</span>
               <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">oanalysis</span><span class="o">.</span><span class="n">AddSweep</span><span class="p">(</span><span class="n">setupname</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span>
        <span class="c1"># self.oanalysis_setup.AddSweep(setupname, arg)</span>
        <span class="c1"># self._messenger.add_debug_message(&quot;Sweep Setup created correctly&quot;)</span>
        <span class="k">return</span> <span class="n">sweepname</span></div></div>





</pre></div>

              </div>
              
              
              <div class='prev-next-bottom'>
                

              </div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright Copyright (c) 2021 ANSYS, Inc. All rights reserved..<br/>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.0.2.<br/>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>